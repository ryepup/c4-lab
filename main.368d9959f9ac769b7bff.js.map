{"version":3,"sources":["webpack:///main.368d9959f9ac769b7bff.js","webpack:///./src/core/index.ts","webpack:///./src/header/index.js","webpack:///./src/core/parse/InvalidDirectionError.ts","webpack:///./src/core/parse/OptsNotFoundError.ts","webpack:///./src/core/parse/NameNotFoundError.ts","webpack:///./src/core/codegen.ts","webpack:///./src/header/about.component.js","webpack:///./src/viewer/index.js","webpack:///./src/index.js","webpack:///./src/editor/index.js","webpack:///./src/editor/editor.component.js","webpack:///./src/editor/editor.html","webpack:///./src/header/nav.component.js","webpack:///./src/header/nav.html","webpack:///./src/header/GitHub-Mark-32px.png","webpack:///./src/core/parse/index.ts","webpack:///./src/core/parse/Parser.ts","webpack:///./src/core/interfaces.ts","webpack:///./src/core/parse/TitleNotAStringError.ts","webpack:///./src/core/parse/TitleNotAtTopLevelError.ts","webpack:///./src/core/DataStore.ts","webpack:///./src/core/exporter/index.ts","webpack:///./src/core/dot-writer.ts","webpack:///./src/core/DOT.ts","webpack:///./src/header/importer.js","webpack:///./src/header/about.html","webpack:///./src/shell/index.js","webpack:///./src/shell/app.component.js","webpack:///./src/core/exporter/gist.ts","webpack:///./src/shell/app.html","webpack:///./src/build-info/index.js","webpack:///./src/build-info/template.html","webpack:///./src/routes.js","webpack:///./src/preview/index.js","webpack:///./src/preview/preview.component.js","webpack:///./src/preview/preview.html","webpack:///./src/viewer/viewer.component.js","webpack:///./src/viewer/viewer.html","webpack:///./src/help/index.js","webpack:///./src/help/help.html","webpack:///./src/help/help.md","webpack:///./src/store/store.module.ts","webpack:///./src/store/actions.ts","webpack:///./src/core/parse/ParseError.ts","webpack:///./src/store/reducers/index.ts","webpack:///./src/store/reducers/c4lab.sexp","webpack:///./src/store/sagas.ts"],"names":["webpackJsonp","112","module","exports","__webpack_require__","Object","defineProperty","value","_index","enumerable","get","parse","ParseError","_codegen","uriEncode","uriDecode","toSvg","_DataStore","DataStore","_exporter","Exporter","formats","_dotWriter","toDot","231","_interopRequireWildcard","obj","__esModule","newObj","key","prototype","hasOwnProperty","call","default","_angular","_angular2","_nav","nav","_about","about","component","name","options","232","_classCallCheck","instance","Constructor","TypeError","_possibleConstructorReturn","self","ReferenceError","_inherits","subClass","superClass","create","constructor","writable","configurable","setPrototypeOf","__proto__","_ParseError2","_ParseError3","InvalidDirectionError","_ParseError","dir","this","getPrototypeOf","233","OptsNotFoundError","type","234","NameNotFoundError","235","toDataUrl","img","createElement","canvas","width","height","context","getContext","drawImage","toDataURL","toPngDataUri","undefined","_lzString","lz","_viz","_viz2","dot","format","engine","text","compressToEncodedURIComponent","uriData","decompressFromEncodedURIComponent","svg","Promise","resolve","onload","setAttribute","encodeURIComponent","236","_about2","template","bindings","close","244","angular","_viewer","viewer","267","_interopRequireDefault","allowBlobsAndDataHrefs","$compileProvider","aHrefSanitizationWhitelist","_angularticsGoogleAnalytics","_angularticsGoogleAnalytics2","_editor","editor","_header","_header2","_shell","shell","_buildInfo","buildInfo","_routes","_routes2","_preview","_preview2","_viewer2","_help","_help2","_store","_store2","_actions","run","install","config","$state","$ngRedux","$window","dispatch","angularInitialized","509","keys","forEach","510","$log","debug","CodeMirror","_codemirror2","EditorController","_createClass","defineProperties","target","props","i","length","descriptor","protoProps","staticProps","_codemirror","_editor2","log","editorOptions","lineNumbers","mode","theme","matchBrackets","autoCloseBrackets","unsubscribe","connect","mapStateToThis","sourceChanged","state","source","parseError","syntaxIsValid","controller","516","517","518","_nav2","_importer","aboutComponent","NavController","$uibModal","exportFormats","zoom","zoomNodeId","href","data","onExport","files","_this","readAllText","then","_onImport","open","519","520","521","522","_InvalidDirectionError","_OptsNotFoundError","_NameNotFoundError","_Parser","Parser","523","_defineProperty","_toArray","arr","Array","isArray","from","isString","x","isList","isAtom","canonicalize","keywordAliases","filter","_ref","test","map","_ref2","to","parseKeywordArgs","kwargs","allowed","arguments","_kwargs","keyword","rest","slice","Error","content","assign","pathToId","_slicedToArray","sliceIterator","_arr","_n","_d","_e","_s","_i","Symbol","iterator","next","done","push","err","_path","path","_sexprPlus","sexp","_md","_interfaces","_InvalidDirectionError2","_NameNotFoundError2","_OptsNotFoundError2","_TitleNotAStringError","_TitleNotAStringError2","_TitleNotAtTopLevelError","_TitleNotAtTopLevelError2","p","Md5","hashStr","idMap","pathMap","edges","items","tokens","buildIR","_iteratorNormalCompletion","_didIteratorError","_iteratorError","_step","_iterator","e","postProcessEdge","return","roots","parentId","id","title","graphTitle","parent","buildIRNode","token","_token$content","head","tail","node","_buildIRNode","isEdge","children","every","canExpand","replace","toLowerCase","trim","edge","item","_tokens","opts","_opts$content","pathToNode","toString","_iteratorNormalCompletion2","_didIteratorError2","_iteratorError2","_step2","_iterator2","n","sourceId","_ref4","_ref5","input","startsWith","src","join","destinationId","direction","sourceParentIds","findParentIds","destinationParentIds","concat","527","528","TitleNotAStringError","JSON","stringify","529","TitleNotAtTopLevelError","532","localStorage","getItem","setItem","533","split","document","safeTitle","png","downloadFile","_dot","dataUri","filename","contentType","a","download","click","534","_toConsumableArray","arr2","DotContext","_lodash","_wordwrap","wordwrap","_DOT","typeShapeMap","actor","container","hrefTo","soft","graph","visibleIds","findVisibleNodes","sort","visibleEdges","isEdgeVisible","_draw","regeneratorRuntime","mark","_this2","wrap","_context","prev","delegateYield","digraphHeaders","rootNode","drawChildCluster","drawCluster","drawItems","drawEdge","stop","visibleNodes","uniq","nodeOrId","indexOf","nodeOrText","htmlNewlines","description","wrapped","edgeOrText","toDescription","isIdVisible","isCrossingSystems","visibleSourceIds","findVisibleIds","visibleDestinationIds","ids","_this3","includes","indent","dotId","label","nonClustered","style","_context2","toDotId","toLabel","DOT","b","otherChildren","nextIndent","_this4","_context3","_context4","font","nodesOrIds","_this5","_context5","drawItem","tech","toTechDescription","desc","shape","attrs","some","tooltip","u","attrList","_this6","srcOk","dstOk","getId","idOk","parentIds","result","find","srcId","dstId","dst","ltail","lhead","getEdgeDirection","ctx","load","draw","537","color","Reflect","ownKeys","quoteAttr","538","file","reader","FileReader","reject","loadEvt","onerror","readAsText","539","540","_app","541","AppController","_gist","_app2","exporter","codeExpanded","GistExporter","export","baseUri","url","l","location","origin","pathname","542","createReadme","_githubApi","_githubApi2","gh","getGist","README.md","public","resp","URL","html_url","578","579","_template","_template2","BuildInfoController","version","build","hash","580","581","configureRoutes","$stateProvider","$urlRouterProvider","otherwise","$stateParams","onEnter","getState","zoomChanged","encodedText","582","previewComponent","583","PreviewComponent","storage","save","go","584","585","ViewerComponent","$sce","bind","expandableNodes","zoomableNodes","trustAsHtml","transclude","586","587","_help3","_help4","HelpController","588","589","593","_reduxSaga","_reduxSaga2","_reducers","_reducers2","_sagas","timingMiddleware","store","action","console","time","group","timeEnd","groupEnd","enhancers","reduxDevtool","window","__REDUX_DEVTOOLS_EXTENSION__","sagas","$ngReduxProvider","createStoreWith","rootSaga","60","svgChanged","dotChanged","sourceParseError","sourceParsed","_typescriptFsa","_typescriptFsa2","actionCreator","61","_extendableBuiltin2","apply","cls","ExtendableBuiltin","construct","669","initialState","_redux","_typescriptFsaReducers","_c4lab","_c4lab2","sourceReducer","reducerWithInitialState","case","old","evt","testSafeSourceReducer","parseErrorReducer","error","graphReducer","zoomableNodesReducer","localeCompare","zoomNodeIdReducer","dotReducer","svgReducer","stateReducer","windowReducer","rootReducer","combineReducers","671","672","onSourceChanged","_core","payload","_effects","put","t0","message","_marked","current","params","render","select","sent","wait","_marked2","ms","setTimeout","updateZoom","abrupt","notify","_marked3","latestSource","takeLatest","_marked4","latestGraph","_marked5","latestZoom","_context6","throttle","_marked6","init","_ref3","_context7","take","_marked7","_context8","all","_marked8"],"mappings":"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","file":"main.368d9959f9ac769b7bff.js","sourcesContent":["webpackJsonp([1],{\n\n/***/ 112:\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _index = __webpack_require__(522);\n\nObject.defineProperty(exports, 'parse', {\n  enumerable: true,\n  get: function get() {\n    return _index.parse;\n  }\n});\nObject.defineProperty(exports, 'ParseError', {\n  enumerable: true,\n  get: function get() {\n    return _index.ParseError;\n  }\n});\n\nvar _codegen = __webpack_require__(235);\n\nObject.defineProperty(exports, 'uriEncode', {\n  enumerable: true,\n  get: function get() {\n    return _codegen.uriEncode;\n  }\n});\nObject.defineProperty(exports, 'uriDecode', {\n  enumerable: true,\n  get: function get() {\n    return _codegen.uriDecode;\n  }\n});\nObject.defineProperty(exports, 'toSvg', {\n  enumerable: true,\n  get: function get() {\n    return _codegen.toSvg;\n  }\n});\n\nvar _DataStore = __webpack_require__(532);\n\nObject.defineProperty(exports, 'DataStore', {\n  enumerable: true,\n  get: function get() {\n    return _DataStore.DataStore;\n  }\n});\n\nvar _exporter = __webpack_require__(533);\n\nObject.defineProperty(exports, 'Exporter', {\n  enumerable: true,\n  get: function get() {\n    return _exporter.Exporter;\n  }\n});\nObject.defineProperty(exports, 'formats', {\n  enumerable: true,\n  get: function get() {\n    return _exporter.formats;\n  }\n});\n\nvar _dotWriter = __webpack_require__(534);\n\nObject.defineProperty(exports, 'toDot', {\n  enumerable: true,\n  get: function get() {\n    return _dotWriter.toDot;\n  }\n});\n\n/***/ }),\n\n/***/ 231:\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _angular = __webpack_require__(41);\n\nvar _angular2 = _interopRequireDefault(_angular);\n\nvar _nav = __webpack_require__(518);\n\nvar nav = _interopRequireWildcard(_nav);\n\nvar _about = __webpack_require__(236);\n\nvar about = _interopRequireWildcard(_about);\n\nfunction _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj.default = obj; return newObj; } }\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nexports.default = _angular2.default.module('c4-lab.header', ['ui.bootstrap', 'ui.router']).component(nav.name, nav.options).component(about.name, about.options).name;\n\n/***/ }),\n\n/***/ 232:\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _ParseError2 = __webpack_require__(61);\n\nvar _ParseError3 = _interopRequireDefault(_ParseError2);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nvar InvalidDirectionError = function (_ParseError) {\n    _inherits(InvalidDirectionError, _ParseError);\n\n    function InvalidDirectionError(dir) {\n        _classCallCheck(this, InvalidDirectionError);\n\n        return _possibleConstructorReturn(this, (InvalidDirectionError.__proto__ || Object.getPrototypeOf(InvalidDirectionError)).call(this, 'Unknown edge direction \"' + dir + '\". valid options are \"push\", \"pull\", or \"both\"'));\n    }\n\n    return InvalidDirectionError;\n}(_ParseError3.default);\n\nexports.default = InvalidDirectionError;\n\n/***/ }),\n\n/***/ 233:\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _ParseError2 = __webpack_require__(61);\n\nvar _ParseError3 = _interopRequireDefault(_ParseError2);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nvar OptsNotFoundError = function (_ParseError) {\n    _inherits(OptsNotFoundError, _ParseError);\n\n    function OptsNotFoundError(type) {\n        _classCallCheck(this, OptsNotFoundError);\n\n        return _possibleConstructorReturn(this, (OptsNotFoundError.__proto__ || Object.getPrototypeOf(OptsNotFoundError)).call(this, 'missing options for a ' + type));\n    }\n\n    return OptsNotFoundError;\n}(_ParseError3.default);\n\nexports.default = OptsNotFoundError;\n\n/***/ }),\n\n/***/ 234:\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _ParseError2 = __webpack_require__(61);\n\nvar _ParseError3 = _interopRequireDefault(_ParseError2);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nvar NameNotFoundError = function (_ParseError) {\n    _inherits(NameNotFoundError, _ParseError);\n\n    function NameNotFoundError(type) {\n        _classCallCheck(this, NameNotFoundError);\n\n        return _possibleConstructorReturn(this, (NameNotFoundError.__proto__ || Object.getPrototypeOf(NameNotFoundError)).call(this, 'missing a name for a ' + type));\n    }\n\n    return NameNotFoundError;\n}(_ParseError3.default);\n\nexports.default = NameNotFoundError;\n\n/***/ }),\n\n/***/ 235:\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.toPngDataUri = exports.uriDecode = exports.uriEncode = exports.toSvg = undefined;\n\nvar _lzString = __webpack_require__(530);\n\nvar lz = _interopRequireWildcard(_lzString);\n\nvar _viz = __webpack_require__(531);\n\nvar _viz2 = _interopRequireDefault(_viz);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj.default = obj; return newObj; } }\n\n/**\n * convert a graph from DOT text to SVG\n */\nvar toSvg = exports.toSvg = function toSvg(dot) {\n    return (0, _viz2.default)(dot, { format: 'svg', engine: 'dot' });\n};\n/**\n * convert a text representation to an URI-encoded representation\n */\nvar uriEncode = exports.uriEncode = function uriEncode(text) {\n    return lz.compressToEncodedURIComponent(text);\n};\n/**\n * convert an URI-encoded representation to a text representation\n */\nvar uriDecode = exports.uriDecode = function uriDecode(uriData) {\n    return lz.decompressFromEncodedURIComponent(uriData);\n};\n/**\n * convert DOT text to a png-encoded data URI\n */\nvar toPngDataUri = exports.toPngDataUri = function toPngDataUri(dot, createElement) {\n    var svg = toSvg(dot);\n    var img = createElement('img');\n    return new Promise(function (resolve) {\n        img.onload = function () {\n            return resolve(toDataUrl(img, createElement));\n        };\n        img.setAttribute('src', 'data:image/svg+xml,' + encodeURIComponent(svg));\n    });\n};\nfunction toDataUrl(img, createElement) {\n    var canvas = createElement('canvas');\n    canvas.width = img.width;\n    canvas.height = img.height;\n    var context = canvas.getContext('2d');\n    if (context) {\n        context.drawImage(img, 0, 0);\n        var dataUrl = canvas.toDataURL('image/png');\n        return dataUrl;\n    }\n}\n\n/***/ }),\n\n/***/ 236:\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.options = exports.name = undefined;\n\nvar _about = __webpack_require__(539);\n\nvar _about2 = _interopRequireDefault(_about);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar name = exports.name = \"c4LabAboutModal\";\nvar options = exports.options = {\n    template: _about2.default,\n    bindings: {\n        close: '&'\n    }\n};\n\n/***/ }),\n\n/***/ 244:\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _angular = __webpack_require__(41);\n\nvar angular = _interopRequireWildcard(_angular);\n\n__webpack_require__(201);\n\n__webpack_require__(202);\n\nvar _viewer = __webpack_require__(585);\n\nvar viewer = _interopRequireWildcard(_viewer);\n\nfunction _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj.default = obj; return newObj; } }\n\nexports.default = angular.module('c4-lab.viewer', ['ui.bootstrap', 'ui.router']).component(viewer.name, viewer.options).name;\n\n/***/ }),\n\n/***/ 267:\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nvar _angular = __webpack_require__(41);\n\nvar angular = _interopRequireWildcard(_angular);\n\n__webpack_require__(269);\n\n__webpack_require__(471);\n\n__webpack_require__(201);\n\n__webpack_require__(202);\n\n__webpack_require__(501);\n\n__webpack_require__(503);\n\n__webpack_require__(505);\n\nvar _angularticsGoogleAnalytics = __webpack_require__(507);\n\nvar _angularticsGoogleAnalytics2 = _interopRequireDefault(_angularticsGoogleAnalytics);\n\nvar _editor = __webpack_require__(509);\n\nvar editor = _interopRequireWildcard(_editor);\n\nvar _header = __webpack_require__(231);\n\nvar _header2 = _interopRequireDefault(_header);\n\nvar _shell = __webpack_require__(540);\n\nvar shell = _interopRequireWildcard(_shell);\n\nvar _buildInfo = __webpack_require__(579);\n\nvar buildInfo = _interopRequireWildcard(_buildInfo);\n\nvar _routes = __webpack_require__(581);\n\nvar _routes2 = _interopRequireDefault(_routes);\n\nvar _preview = __webpack_require__(582);\n\nvar _preview2 = _interopRequireDefault(_preview);\n\nvar _viewer = __webpack_require__(244);\n\nvar _viewer2 = _interopRequireDefault(_viewer);\n\nvar _help = __webpack_require__(587);\n\nvar _help2 = _interopRequireDefault(_help);\n\nvar _store = __webpack_require__(593);\n\nvar _store2 = _interopRequireDefault(_store);\n\nvar _actions = __webpack_require__(60);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj.default = obj; return newObj; } }\n\nangular.module('c4-lab', ['ui.codemirror', 'ui.bootstrap', 'ui.router', 'ngAnimate', 'ngFileUpload', _angularticsGoogleAnalytics2.default, _header2.default, _preview2.default, _viewer2.default, _help2.default, _store2.default]).component(buildInfo.name, buildInfo.options).component(editor.name, editor.options).component(shell.name, shell.options).run(editor.install).config(allowBlobsAndDataHrefs).config(_routes2.default).run(function ($state, $ngRedux, $window) {\n  $ngRedux.dispatch((0, _actions.angularInitialized)({ $state: $state, $window: $window }));\n});\n\n// @ngInject\nfunction allowBlobsAndDataHrefs($compileProvider) {\n  $compileProvider.aHrefSanitizationWhitelist(/^(https?|ftp|mailto|blob|data):/i);\n}\n\n/***/ }),\n\n/***/ 509:\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _editor = __webpack_require__(510);\n\nObject.keys(_editor).forEach(function (key) {\n  if (key === \"default\" || key === \"__esModule\") return;\n  Object.defineProperty(exports, key, {\n    enumerable: true,\n    get: function get() {\n      return _editor[key];\n    }\n  });\n});\n\n/***/ }),\n\n/***/ 510:\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.options = exports.name = exports.EditorController = undefined;\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nexports.install = install;\n\n__webpack_require__(511);\n\n__webpack_require__(512);\n\n__webpack_require__(513);\n\n__webpack_require__(514);\n\n__webpack_require__(515);\n\nvar _codemirror = __webpack_require__(111);\n\nvar _codemirror2 = _interopRequireDefault(_codemirror);\n\nvar _editor = __webpack_require__(516);\n\nvar _editor2 = _interopRequireDefault(_editor);\n\n__webpack_require__(517);\n\nvar _actions = __webpack_require__(60);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar EditorController = exports.EditorController = function () {\n    function EditorController($log, $ngRedux) {\n        'ngInject';\n\n        _classCallCheck(this, EditorController);\n\n        this.log = $log;\n        this.editorOptions = {\n            lineNumbers: true,\n            mode: \"commonlisp\",\n            theme: \"elegant\",\n            matchBrackets: true,\n            autoCloseBrackets: true\n        };\n\n        this.unsubscribe = $ngRedux.connect(this.mapStateToThis, { sourceChanged: _actions.sourceChanged })(this);\n    }\n\n    _createClass(EditorController, [{\n        key: '$onDestroy',\n        value: function $onDestroy() {\n            this.unsubscribe();\n        }\n    }, {\n        key: 'mapStateToThis',\n        value: function mapStateToThis(state) {\n            return {\n                text: state.source,\n                parseError: state.parseError,\n                syntaxIsValid: state.parseError ? false : true\n            };\n        }\n    }, {\n        key: 'parse',\n        value: function parse(text) {\n            this.sourceChanged({ source: text });\n        }\n    }]);\n\n    return EditorController;\n}();\n\nvar name = exports.name = \"c4LabEditor\";\nvar options = exports.options = {\n    template: _editor2.default,\n    controller: EditorController\n\n    // @ngInject\n};function install($window, $log) {\n    $log.debug('installing codemirror');\n    $window.CodeMirror = _codemirror2.default;\n}\n\n/***/ }),\n\n/***/ 516:\n/***/ (function(module, exports) {\n\nmodule.exports = \"<div ng-class=\\\"{'bg-success': $ctrl.syntaxIsValid, 'bg-danger': !$ctrl.syntaxIsValid}\\\" style=\\\"padding: 0 1em;\\\">\\n    <ui-codemirror ui-codemirror-opts=\\\"$ctrl.editorOptions\\\" ng-model=\\\"$ctrl.text\\\" ng-model-options=\\\"{ debounce: 250 }\\\"\\n        ng-change=\\\"$ctrl.parse($ctrl.text)\\\">\\n    </ui-codemirror>\\n    <span class=\\\"help-block\\\">{{ $ctrl.parseError }}</span>\\n</div>\";\n\n/***/ }),\n\n/***/ 517:\n/***/ (function(module, exports) {\n\n// removed by extract-text-webpack-plugin\n\n/***/ }),\n\n/***/ 518:\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.options = exports.name = undefined;\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n// TODO: don't need core, just look at redux\n\n\nvar _nav = __webpack_require__(519);\n\nvar _nav2 = _interopRequireDefault(_nav);\n\n__webpack_require__(521);\n\nvar _index = __webpack_require__(112);\n\nvar _importer = __webpack_require__(538);\n\nvar _about = __webpack_require__(236);\n\nvar aboutComponent = _interopRequireWildcard(_about);\n\nvar _actions = __webpack_require__(60);\n\nfunction _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj.default = obj; return newObj; } }\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar NavController = function () {\n    function NavController($state, $uibModal, $ngRedux) {\n        'ngInject';\n\n        _classCallCheck(this, NavController);\n\n        this.$state = $state;\n        this.$uibModal = $uibModal;\n        this.exportFormats = _index.formats;\n\n        this.unsubscribe = $ngRedux.connect(this.mapStateToThis, { sourceChanged: _actions.sourceChanged })(this);\n    }\n\n    _createClass(NavController, [{\n        key: '$onDestroy',\n        value: function $onDestroy() {\n            this.unsubscribe();\n        }\n    }, {\n        key: 'mapStateToThis',\n        value: function mapStateToThis(state) {\n            return { text: state.source, zoom: state.zoomNodeId };\n        }\n    }, {\n        key: 'href',\n        value: function href(zoom) {\n            return this.$state.href('load', {\n                data: (0, _index.uriEncode)(this.text),\n                zoom: zoom\n            });\n        }\n    }, {\n        key: 'export',\n        value: function _export(format) {\n            this.onExport({ format: format, href: this.href() });\n        }\n    }, {\n        key: 'import',\n        value: function _import(files) {\n            var _this = this;\n\n            if (files) {\n                (0, _importer.readAllText)(files[0]).then(function (text) {\n                    return _this._onImport(text);\n                });\n            }\n        }\n    }, {\n        key: 'openAbout',\n        value: function openAbout() {\n            this.$uibModal.open({\n                component: aboutComponent.name\n            });\n        }\n    }, {\n        key: '_onImport',\n        value: function _onImport(text) {\n            this.sourceChanged({ source: text });\n        }\n    }]);\n\n    return NavController;\n}();\n\nvar name = exports.name = \"c4LabNav\";\nvar options = exports.options = {\n    template: _nav2.default,\n    controller: NavController,\n    bindings: {\n        onExport: '&'\n    }\n\n};\n\n/***/ }),\n\n/***/ 519:\n/***/ (function(module, exports, __webpack_require__) {\n\nmodule.exports = \"<nav class=\\\"navbar navbar-default\\\">\\n    <div class=\\\"container-fluid\\\">\\n        <div class=\\\"navbar-header\\\">\\n            <a class=\\\"navbar-brand\\\" href=\\\"#\\\">C4 Lab</a>\\n        </div>\\n\\n        <p class=\\\"navbar-text navbar-right c4lab-build\\\">\\n            <c4-lab-build-info></c4-lab-build-info>\\n        </p>\\n\\n        <div class=\\\"navbar-collapse collapse\\\">\\n            <ul class=\\\"nav navbar-nav\\\">\\n                <li>\\n                    <a popover-placement=\\\"bottom\\\" uib-popover-template=\\\"'_share.html'\\\" analytics-on=\\\"click\\\"\\n                        analytics-event=\\\"share\\\">\\n                        <span class=\\\"glyphicon glyphicon-duplicate\\\"> </span> Share\\n                    </a>\\n                </li>\\n                <li>\\n                    <a ngf-select=\\\"$ctrl.import($files)\\\" ngf-pattern=\\\"'.sexp'\\\" ngf-accept=\\\"'.sexp'\\\" analytics-on=\\\"click\\\"\\n                        analytics-event=\\\"import\\\">\\n                        <span class=\\\"glyphicon glyphicon-open-file\\\"> </span> Import\\n                    </a>\\n                </li>\\n                <li class=\\\"dropdown\\\" uib-dropdown>\\n                    <a uib-dropdown-toggle>\\n                        <span class=\\\"glyphicon glyphicon-picture\\\"> </span> Export <span class=\\\"caret\\\"></span>\\n                    </a>\\n                    <ul id=\\\"export-format-list\\\" class=\\\"dropdown-menu\\\" uib-dropdown-menu>\\n                        <li ng-repeat=\\\"format in $ctrl.exportFormats\\\">\\n                            <a ng-click=\\\"$ctrl.export(format)\\\" analytics-on=\\\"click\\\" analytics-event=\\\"export\\\"\\n                                analytics-label=\\\"{{format}}\\\">{{format}}</a>\\n                        </li>\\n                        <!-- TODO: fix gist integration with oauth login\\n                            <li>\\n                                <a ng-click=\\\"$ctrl.export('gist')\\\" analytics-on=\\\"click\\\" analytics-event=\\\"export\\\" analytics-label=\\\"gist\\\">GitHub Gist&nbsp;<img src=\\\"\" + __webpack_require__(520) + \"\\\"></a>\\n                            </li>\\n                        -->\\n                    </ul>\\n                </li>\\n                <li>\\n                    <!-- TODO: make this a modal route-->\\n                    <a href=\\\"#\\\" ng-click=\\\"$ctrl.openAbout()\\\" analytics-on=\\\"click\\\" analytics-event=\\\"about\\\">\\n                        <span class=\\\"glyphicon glyphicon-info-sign\\\"> </span> About\\n                    </a>\\n                </li>\\n                <li>\\n                    <a ui-sref=\\\"help\\\">\\n                        <span class=\\\"glyphicon glyphicon-question-sign\\\"> </span> Help\\n                    </a>\\n                </li>\\n            </ul>\\n        </div>\\n    </div>\\n</nav>\\n\\n<script type=\\\"text/ng-template\\\" id=\\\"_share.html\\\">\\n    <div style=\\\"width:10em;\\\">\\n        <a ng-href=\\\"{{$ctrl.href($ctrl.zoom)}}\\\" target=\\\"_blank\\\">\\n            <span class=\\\"glyphicon glyphicon-new-window\\\" > </span>\\n            Link to this page</a>\\n    </div>\\n</script>\";\n\n/***/ }),\n\n/***/ 520:\n/***/ (function(module, exports) {\n\nmodule.exports = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyRpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMy1jMDExIDY2LjE0NTY2MSwgMjAxMi8wMi8wNi0xNDo1NjoyNyAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNiAoTWFjaW50b3NoKSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDpFNTE3OEEyQTk5QTAxMUUyOUExNUJDMTA0NkE4OTA0RCIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDpFNTE3OEEyQjk5QTAxMUUyOUExNUJDMTA0NkE4OTA0RCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkU1MTc4QTI4OTlBMDExRTI5QTE1QkMxMDQ2QTg5MDREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOkU1MTc4QTI5OTlBMDExRTI5QTE1QkMxMDQ2QTg5MDREIi8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+m4QGuQAAAyRJREFUeNrEl21ojWEYx895TDPbMNlBK46IUiNmPvHBSUjaqc0H8pF5+aDUKPEBqU2NhRQpX5Rv5jWlDIWlMCv7MMSWsWwmb3tpXub4XXWdPHvc9/Gc41nu+nedc7/8r/99PffLdYdDPsvkwsgkTBwsA/PADJCnzX2gHTwBt8Hl7p537/3whn04XoDZDcpBlk+9P8AFcAghzRkJwPF4zGGw0Y9QS0mAM2AnQj77FqCzrtcwB1Hk81SYojHK4DyGuQ6mhIIrBWB9Xm7ug/6B/nZrBHBegrkFxoVGpnwBMSLR9EcEcC4qb8pP14BWcBcUgewMnF3T34VqhWMFkThLJAalwnENOAKiHpJq1FZgI2AT6HZtuxZwR9GidSHtI30jOrbawxlVX78/AbNfhHlomEUJJI89O2MqeE79T8/nk8nMBm/dK576hZgmA3cp/R4l9/UeSxiHLVIlNm4nFfT0bxyuIj7LHRTKai+zdJobwMKzcZSJb0ePV5PKN+BqAAKE47UlMnERELMM3EdYP/yrd+XYb2mOiYBiQ8OQnoRBlXrl9JZix7D1pHTazu4MoyBcnYamqAjIMTR8G4FT8LuhLsexXYYjICBiqhQBvYb6fLZIJCjPypVvaOoVAW2WcasCnL2Nq82xHJNSqlCeFcDshaPK0twkAhosjZL31QYw+1rlMpWGMArl23SBsZZO58F2tlJXmjOXS+s4WGvpMiBJT/I2PInZ6lIs9/hBsNS1hS6BG0DSqmYEDRlCXQrmy50P1oDRKTSegmNbUsA0zDMwRhPJXeCE3vWLPQMvan6X8AgIa1vcR4AkGZkDR4ejJ1UHpsaVI0g2LInpOsNFUud1rhxSV+fzC9Woz2EZkWQuja7/B+jUrgtIMpy9YCW4n4K41YfzRneW5E1KJTe4B2Zq1Q5EHEtj4U3AfEzR5SVY4l7QYQPJdN2as7RKBF0BPZqqH4VgMAMBL8Byxr7y8zCZiDlnOcEKIPmUpgB5Z2ww5RdOiiRiNajUmWda5IG6WbhsyY2fx6m8gLcoJDJFkH219M3We1+cnda93pfycZpIJEL/s/wSYADmOAwAQgdpBAAAAABJRU5ErkJggg==\"\n\n/***/ }),\n\n/***/ 521:\n/***/ (function(module, exports) {\n\n// removed by extract-text-webpack-plugin\n\n/***/ }),\n\n/***/ 522:\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.parse = exports.NameNotFoundError = exports.OptsNotFoundError = exports.InvalidDirectionError = exports.ParseError = undefined;\n\nvar _ParseError = __webpack_require__(61);\n\nObject.defineProperty(exports, 'ParseError', {\n  enumerable: true,\n  get: function get() {\n    return _interopRequireDefault(_ParseError).default;\n  }\n});\n\nvar _InvalidDirectionError = __webpack_require__(232);\n\nObject.defineProperty(exports, 'InvalidDirectionError', {\n  enumerable: true,\n  get: function get() {\n    return _interopRequireDefault(_InvalidDirectionError).default;\n  }\n});\n\nvar _OptsNotFoundError = __webpack_require__(233);\n\nObject.defineProperty(exports, 'OptsNotFoundError', {\n  enumerable: true,\n  get: function get() {\n    return _interopRequireDefault(_OptsNotFoundError).default;\n  }\n});\n\nvar _NameNotFoundError = __webpack_require__(234);\n\nObject.defineProperty(exports, 'NameNotFoundError', {\n  enumerable: true,\n  get: function get() {\n    return _interopRequireDefault(_NameNotFoundError).default;\n  }\n});\n\nvar _Parser = __webpack_require__(523);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar parse = exports.parse = function parse(text) {\n  return new _Parser.Parser().parse(text);\n};\n\n/***/ }),\n\n/***/ 523:\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.Parser = exports.pathToId = undefined;\n\nvar _slicedToArray = function () { function sliceIterator(arr, i) { var _arr = []; var _n = true; var _d = false; var _e = undefined; try { for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i[\"return\"]) _i[\"return\"](); } finally { if (_d) throw _e; } } return _arr; } return function (arr, i) { if (Array.isArray(arr)) { return arr; } else if (Symbol.iterator in Object(arr)) { return sliceIterator(arr, i); } else { throw new TypeError(\"Invalid attempt to destructure non-iterable instance\"); } }; }();\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _path = __webpack_require__(524);\n\nvar path = _interopRequireWildcard(_path);\n\nvar _sexprPlus = __webpack_require__(525);\n\nvar sexp = _interopRequireWildcard(_sexprPlus);\n\nvar _md = __webpack_require__(526);\n\nvar _interfaces = __webpack_require__(527);\n\nvar _InvalidDirectionError = __webpack_require__(232);\n\nvar _InvalidDirectionError2 = _interopRequireDefault(_InvalidDirectionError);\n\nvar _NameNotFoundError = __webpack_require__(234);\n\nvar _NameNotFoundError2 = _interopRequireDefault(_NameNotFoundError);\n\nvar _OptsNotFoundError = __webpack_require__(233);\n\nvar _OptsNotFoundError2 = _interopRequireDefault(_OptsNotFoundError);\n\nvar _ParseError = __webpack_require__(61);\n\nvar _ParseError2 = _interopRequireDefault(_ParseError);\n\nvar _TitleNotAStringError = __webpack_require__(528);\n\nvar _TitleNotAStringError2 = _interopRequireDefault(_TitleNotAStringError);\n\nvar _TitleNotAtTopLevelError = __webpack_require__(529);\n\nvar _TitleNotAtTopLevelError2 = _interopRequireDefault(_TitleNotAtTopLevelError);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj.default = obj; return newObj; } }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nfunction _toArray(arr) { return Array.isArray(arr) ? arr : Array.from(arr); }\n\nvar pathToId = exports.pathToId = function pathToId(p) {\n    return _md.Md5.hashStr(p, false);\n};\nfunction isString(x) {\n    return x && x.type === 'string';\n}\nfunction isList(x) {\n    return x && x.type === 'list';\n}\nfunction isAtom(x) {\n    return x && x.type === 'atom';\n}\nvar stripComments = function stripComments(text) {\n    return text.replace(/^\\s*;;.*$/gm, '');\n};\nvar keywordAliases = [{ from: /^:desc.*/i, to: 'description' }, { from: /^:to/i, to: 'to' }, { from: /^:tech/i, to: 'tech' }, { from: /^:dir.*/i, to: 'direction' }];\nfunction canonicalize(key) {\n    return keywordAliases.filter(function (_ref) {\n        var from = _ref.from;\n        return from.test(key);\n    }).map(function (_ref2) {\n        var to = _ref2.to;\n        return to;\n    })[0] || key;\n}\nfunction parseKeywordArgs(kwargs) {\n    var allowed = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : /.*/;\n\n    if (kwargs.length === 0) {\n        return {};\n    }\n\n    var _kwargs = _toArray(kwargs),\n        keyword = _kwargs[0],\n        value = _kwargs[1],\n        rest = _kwargs.slice(2);\n\n    if (!isAtom(keyword)) {\n        throw new Error('Expected keyword to be an atom');\n    }\n    if (!isString(value)) {\n        throw new Error('Expected value to be a string');\n    }\n    var key = canonicalize(keyword.content);\n    return Object.assign(allowed.test(key) ? _defineProperty({}, key, value.content) : {}, parseKeywordArgs(rest, allowed));\n}\n\nvar Parser = exports.Parser = function () {\n    function Parser() {\n        _classCallCheck(this, Parser);\n\n        this.idMap = {};\n        this.pathMap = {};\n        this.edges = [];\n        this.items = [];\n    }\n\n    _createClass(Parser, [{\n        key: 'parse',\n        value: function parse(text) {\n            var tokens = sexp.parse(text);\n            this.buildIR(tokens);\n            var _iteratorNormalCompletion = true;\n            var _didIteratorError = false;\n            var _iteratorError = undefined;\n\n            try {\n                for (var _iterator = this.edges[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n                    var e = _step.value;\n\n                    this.postProcessEdge(e);\n                }\n            } catch (err) {\n                _didIteratorError = true;\n                _iteratorError = err;\n            } finally {\n                try {\n                    if (!_iteratorNormalCompletion && _iterator.return) {\n                        _iterator.return();\n                    }\n                } finally {\n                    if (_didIteratorError) {\n                        throw _iteratorError;\n                    }\n                }\n            }\n\n            return {\n                edges: this.edges,\n                idMap: this.idMap,\n                items: this.items,\n                pathMap: this.pathMap,\n                roots: this.items.filter(function (x) {\n                    return !x.parentId;\n                }).map(function (x) {\n                    return x.id;\n                }),\n                title: this.graphTitle\n            };\n        }\n    }, {\n        key: 'buildIR',\n        value: function buildIR(tokens, parent) {\n            var _this = this;\n\n            return tokens.map(function (x) {\n                return _this.buildIRNode(x, parent);\n            });\n        }\n    }, {\n        key: 'buildIRNode',\n        value: function buildIRNode(token, parent) {\n            if (!isList(token)) {\n                throw new Error('bare string not permitted');\n            }\n\n            var _token$content = _toArray(token.content),\n                head = _token$content[0],\n                tail = _token$content.slice(1);\n\n            if (!isAtom(head)) {\n                throw new Error('expected atom, found ' + head.type);\n            }\n            var node = this._buildIRNode(head.content, tail, parent);\n            if (!node) {\n                return null;\n            }\n            if (!(0, _interfaces.isEdge)(node) && !node.children.every(_interfaces.isEdge)) {\n                node.canExpand = true;\n            }\n            return node;\n        }\n    }, {\n        key: '_buildIRNode',\n        value: function _buildIRNode(head, tail, parent) {\n            var type = head.replace(/^def(ine)?-/i, '').toLowerCase().trim();\n            switch (type) {\n                case 'edge':\n                    return this.edge(tail, parent);\n                case 'title':\n                    this.title(tail, parent);\n                    return null;\n                default:\n                    return this.item(type, tail, parent);\n            }\n        }\n    }, {\n        key: 'item',\n        value: function item(type, tokens, parent) {\n            var _tokens = _toArray(tokens),\n                opts = _tokens[0],\n                children = _tokens.slice(1);\n\n            if (!isList(opts)) {\n                throw new _OptsNotFoundError2.default(type);\n            }\n\n            var _opts$content = _toArray(opts.content),\n                name = _opts$content[0],\n                kwargs = _opts$content.slice(1);\n\n            if (!isString(name) || name.content === '') {\n                throw new _NameNotFoundError2.default(type);\n            }\n            var p = this.pathToNode(name.content, parent).toString();\n            var node = {\n                children: [],\n                id: pathToId(p),\n                name: name.content,\n                path: p,\n                type: type\n            };\n            if (parent) {\n                node.parentId = parent.id;\n            }\n            this.idMap[node.id] = node;\n            this.pathMap[node.path] = node.id;\n            Object.assign(node, parseKeywordArgs(kwargs, /description|tech/));\n            this.items.push(node);\n            var _iteratorNormalCompletion2 = true;\n            var _didIteratorError2 = false;\n            var _iteratorError2 = undefined;\n\n            try {\n                for (var _iterator2 = this.buildIR(children, node)[Symbol.iterator](), _step2; !(_iteratorNormalCompletion2 = (_step2 = _iterator2.next()).done); _iteratorNormalCompletion2 = true) {\n                    var n = _step2.value;\n\n                    if (n) {\n                        node.children.push(n);\n                    }\n                }\n            } catch (err) {\n                _didIteratorError2 = true;\n                _iteratorError2 = err;\n            } finally {\n                try {\n                    if (!_iteratorNormalCompletion2 && _iterator2.return) {\n                        _iterator2.return();\n                    }\n                } finally {\n                    if (_didIteratorError2) {\n                        throw _iteratorError2;\n                    }\n                }\n            }\n\n            return node;\n        }\n    }, {\n        key: 'edge',\n        value: function edge(kwargs, parent) {\n            if (!parent) {\n                throw new Error('edge at top level?');\n            }\n            var edge = Object.assign({ sourceId: parent.id, type: 'edge' }, parseKeywordArgs(kwargs, /description|to|tech|direction/));\n            this.edges.push(edge);\n            return edge;\n        }\n    }, {\n        key: 'title',\n        value: function title(_ref4, parent) {\n            var _ref5 = _slicedToArray(_ref4, 1),\n                input = _ref5[0];\n\n            if (!isString(input)) {\n                throw new _TitleNotAStringError2.default(input.toString());\n            }\n            if (parent) {\n                throw new _TitleNotAtTopLevelError2.default();\n            }\n            this.graphTitle = input.content;\n        }\n    }, {\n        key: 'pathToNode',\n        value: function pathToNode(name, parent) {\n            return parent ? this.idMap[parent.id].path + '/' + name : name;\n        }\n    }, {\n        key: 'postProcessEdge',\n        value: function postProcessEdge(edge) {\n            if (edge.to.startsWith('.')) {\n                var src = this.idMap[edge.sourceId];\n                if (!src.parentId) {\n                    throw new Error('relative paths have to have a parent');\n                }\n                var parent = this.idMap[src.parentId];\n                edge.to = path.join(parent.path, edge.to);\n            }\n            edge.destinationId = this.pathMap[edge.to];\n            if (!edge.destinationId) {\n                throw new _ParseError2.default('Could not find node \\'' + edge.to + '\\'');\n            }\n            if (edge.sourceId === edge.destinationId) {\n                throw new _ParseError2.default('Edge cannot be both from and to \\'' + edge.to + '\\'');\n            }\n            if (edge.direction) {\n                if (/^(push|pull|both)$/i.test(edge.direction)) {\n                    edge.direction = edge.direction.toLowerCase();\n                } else {\n                    throw new _InvalidDirectionError2.default(edge.direction);\n                }\n            }\n            edge.id = pathToId(edge.sourceId + edge.destinationId);\n            edge.sourceParentIds = this.findParentIds(edge.sourceId);\n            edge.destinationParentIds = this.findParentIds(edge.destinationId);\n        }\n    }, {\n        key: 'findParentIds',\n        value: function findParentIds(id) {\n            var node = this.idMap[id];\n            if (!node.parentId) {\n                return [];\n            }\n            return [node.parentId].concat(this.findParentIds(node.parentId));\n        }\n    }]);\n\n    return Parser;\n}();\n/*\nTODO: detect errors:\n\n* duplicate paths\n\n*/\n\n/***/ }),\n\n/***/ 527:\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.isEdge = isEdge;\nfunction isEdge(x) {\n    return x.type === 'edge';\n}\n\n/***/ }),\n\n/***/ 528:\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _ParseError2 = __webpack_require__(61);\n\nvar _ParseError3 = _interopRequireDefault(_ParseError2);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nvar TitleNotAStringError = function (_ParseError) {\n    _inherits(TitleNotAStringError, _ParseError);\n\n    function TitleNotAStringError(input) {\n        _classCallCheck(this, TitleNotAStringError);\n\n        return _possibleConstructorReturn(this, (TitleNotAStringError.__proto__ || Object.getPrototypeOf(TitleNotAStringError)).call(this, 'title must be a string, was: ' + JSON.stringify(input)));\n    }\n\n    return TitleNotAStringError;\n}(_ParseError3.default);\n\nexports.default = TitleNotAStringError;\n\n/***/ }),\n\n/***/ 529:\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _ParseError2 = __webpack_require__(61);\n\nvar _ParseError3 = _interopRequireDefault(_ParseError2);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nvar TitleNotAtTopLevelError = function (_ParseError) {\n    _inherits(TitleNotAtTopLevelError, _ParseError);\n\n    function TitleNotAtTopLevelError() {\n        _classCallCheck(this, TitleNotAtTopLevelError);\n\n        return _possibleConstructorReturn(this, (TitleNotAtTopLevelError.__proto__ || Object.getPrototypeOf(TitleNotAtTopLevelError)).call(this, 'title is only allowed at the top level'));\n    }\n\n    return TitleNotAtTopLevelError;\n}(_ParseError3.default);\n\nexports.default = TitleNotAtTopLevelError;\n\n/***/ }),\n\n/***/ 532:\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar LOCALSTORAGE_KEY = 'C4-LAB-ACTIVE-DOC-VNEXT';\n\nvar DataStore = exports.DataStore = function () {\n    function DataStore(localStorage) {\n        _classCallCheck(this, DataStore);\n\n        this.localStorage = localStorage;\n    }\n\n    _createClass(DataStore, [{\n        key: 'load',\n        value: function load() {\n            return this.localStorage.getItem(LOCALSTORAGE_KEY);\n        }\n    }, {\n        key: 'save',\n        value: function save(text) {\n            this.localStorage.setItem(LOCALSTORAGE_KEY, text);\n        }\n    }]);\n\n    return DataStore;\n}();\n\n/***/ }),\n\n/***/ 533:\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.Exporter = exports.formats = undefined;\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _codegen = __webpack_require__(235);\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar formats = exports.formats = 'sexp dot png'.split(' ');\n\nvar Exporter = function () {\n    function Exporter(document) {\n        _classCallCheck(this, Exporter);\n\n        this.createElement = function (e) {\n            return document.createElement(e);\n        };\n    }\n\n    _createClass(Exporter, [{\n        key: 'export',\n        value: function _export(format, title, text, dot) {\n            var safeTitle = title || 'c4-lab-graph';\n            switch (format) {\n                case 'sexp':\n                    return this.sexp(safeTitle, text);\n                case 'dot':\n                    return this.dot(safeTitle, dot);\n                case 'png':\n                    return this.png(safeTitle, dot);\n                default:\n                    throw new Error('unknown format: ' + format);\n            }\n        }\n    }, {\n        key: 'sexp',\n        value: function sexp(title, text) {\n            this.downloadFile(title + '.sexp', text, 'text/plain');\n        }\n    }, {\n        key: 'dot',\n        value: function dot(title, _dot) {\n            this.downloadFile(title + '.dot', _dot, 'text/plain');\n        }\n    }, {\n        key: 'png',\n        value: function png(title, dot) {\n            var _this = this;\n\n            (0, _codegen.toPngDataUri)(dot, this.createElement).then(function (dataUri) {\n                return _this.downloadFile(title + '.png', dataUri);\n            });\n        }\n    }, {\n        key: 'downloadFile',\n        value: function downloadFile(filename, content, contentType) {\n            var a = this.createElement('a');\n            a.download = filename;\n            if (contentType) {\n                a.href = 'data:' + contentType + ',' + encodeURIComponent(content);\n            } else {\n                a.href = content;\n            }\n            a.click();\n        }\n    }]);\n\n    return Exporter;\n}();\n\nexports.Exporter = Exporter;\n\n/***/ }),\n\n/***/ 534:\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.toDot = exports.DotContext = undefined;\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _lodash = __webpack_require__(535);\n\nvar _wordwrap = __webpack_require__(536);\n\nvar wordwrap = _interopRequireWildcard(_wordwrap);\n\nvar _DOT = __webpack_require__(537);\n\nfunction _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj.default = obj; return newObj; } }\n\nfunction _toConsumableArray(arr) { if (Array.isArray(arr)) { for (var i = 0, arr2 = Array(arr.length); i < arr.length; i++) { arr2[i] = arr[i]; } return arr2; } else { return Array.from(arr); } }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar DEFAULT_SHAPE = 'box';\nvar typeShapeMap = {\n    actor: 'egg',\n    component: 'component',\n    container: 'box3d'\n};\nvar VERBOSE = false;\nvar INDENT = '  ';\n\nvar DotContext = exports.DotContext = function () {\n    function DotContext(hrefTo) {\n        _classCallCheck(this, DotContext);\n\n        // TODO: why doesn't `wordwrap(30)` work? Something about typescript definitions\n        this.wordwrap = wordwrap.soft(0, 30);\n        this.hrefTo = hrefTo;\n    }\n\n    _createClass(DotContext, [{\n        key: 'load',\n        value: function load(graph, zoomNodeId) {\n            var _this = this;\n\n            this.graph = graph;\n            this.zoomNodeId = zoomNodeId;\n            this.visibleIds = zoomNodeId ? this.findVisibleNodes(zoomNodeId) : graph.roots;\n            this.visibleIds.sort();\n            this.visibleEdges = graph.edges.filter(function (x) {\n                return _this.isEdgeVisible(x);\n            });\n        }\n    }, {\n        key: 'draw',\n        value: function draw() {\n            return [].concat(_toConsumableArray(this._draw())).join('\\n');\n        }\n    }, {\n        key: '_draw',\n        value: /*#__PURE__*/regeneratorRuntime.mark(function _draw() {\n            var _this2 = this;\n\n            return regeneratorRuntime.wrap(function _draw$(_context) {\n                while (1) {\n                    switch (_context.prev = _context.next) {\n                        case 0:\n                            _context.next = 2;\n                            return 'digraph g {';\n\n                        case 2:\n                            return _context.delegateYield(this.digraphHeaders(INDENT), 't0', 3);\n\n                        case 3:\n                            if (!this.rootNode) {\n                                _context.next = 11;\n                                break;\n                            }\n\n                            if (!this.rootNode.parentId) {\n                                _context.next = 8;\n                                break;\n                            }\n\n                            return _context.delegateYield(this.drawChildCluster(INDENT, this.rootNode.parentId), 't1', 6);\n\n                        case 6:\n                            _context.next = 9;\n                            break;\n\n                        case 8:\n                            return _context.delegateYield(this.drawCluster(INDENT, this.rootNode), 't2', 9);\n\n                        case 9:\n                            _context.next = 12;\n                            break;\n\n                        case 11:\n                            return _context.delegateYield(this.drawItems(this.visibleIds, INDENT), 't3', 12);\n\n                        case 12:\n                            _context.next = 14;\n                            return '';\n\n                        case 14:\n                            return _context.delegateYield(this.visibleEdges.map(function (x) {\n                                return _this2.drawEdge(x, INDENT);\n                            }), 't4', 15);\n\n                        case 15:\n                            _context.next = 17;\n                            return '}';\n\n                        case 17:\n                            _context.next = 19;\n                            return '';\n\n                        case 19:\n                        case 'end':\n                            return _context.stop();\n                    }\n                }\n            }, _draw, this);\n        })\n    }, {\n        key: 'findVisibleNodes',\n        value: function findVisibleNodes(zoomNodeId) {\n            this.rootNode = this.graph.idMap[zoomNodeId];\n            var visibleNodes = this.rootNode.children.concat([this.rootNode]);\n            if (this.rootNode.parentId) {\n                var parent = this.graph.idMap[this.rootNode.parentId];\n                visibleNodes = visibleNodes.concat(parent.children);\n                visibleNodes.push(parent);\n            }\n            var visibleIds = visibleNodes.map(function (x) {\n                return x.id;\n            }).concat(this.graph.roots).filter(function (x) {\n                return x;\n            });\n            return (0, _lodash.uniq)(visibleIds);\n        }\n    }, {\n        key: 'toDotId',\n        value: function toDotId(nodeOrId) {\n            var id = (0, _lodash.isString)(nodeOrId) ? nodeOrId : nodeOrId.id;\n            return 'g' + this.visibleIds.indexOf(id);\n        }\n    }, {\n        key: 'toDescription',\n        value: function toDescription(nodeOrText) {\n            var htmlNewlines = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : true;\n\n            var text = (0, _lodash.isString)(nodeOrText) ? nodeOrText : nodeOrText.description;\n            if (!text) {\n                return '';\n            }\n            var wrapped = this.wordwrap(text);\n            return htmlNewlines ? wrapped.replace(/\\n/g, '<br/>\\n') : wrapped;\n        }\n    }, {\n        key: 'toLabel',\n        value: function toLabel(edgeOrText) {\n            return this.toDescription(edgeOrText, false).replace(/\"/g, '\\\\\"').replace(/\\n/g, '\\\\n');\n        }\n    }, {\n        key: 'isEdgeVisible',\n        value: function isEdgeVisible(edge) {\n            return this.isIdVisible(edge.sourceId) || this.isIdVisible(edge.destinationId) || this.isCrossingSystems(edge);\n        }\n    }, {\n        key: 'isCrossingSystems',\n        value: function isCrossingSystems(edge) {\n            var visibleSourceIds = this.findVisibleIds(edge.sourceParentIds);\n            var visibleDestinationIds = this.findVisibleIds(edge.destinationParentIds);\n            return visibleSourceIds[0] !== visibleDestinationIds[0];\n        }\n    }, {\n        key: 'findVisibleIds',\n        value: function findVisibleIds(ids) {\n            var _this3 = this;\n\n            return ids.filter(function (x) {\n                return _this3.isIdVisible(x);\n            });\n        }\n    }, {\n        key: 'isIdVisible',\n        value: function isIdVisible(id) {\n            return this.visibleIds.includes(id);\n        }\n    }, {\n        key: 'drawCluster',\n        value: /*#__PURE__*/regeneratorRuntime.mark(function drawCluster(indent, rootNode) {\n            var style = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 'rounded';\n            var dotId, label, nonClustered;\n            return regeneratorRuntime.wrap(function drawCluster$(_context2) {\n                while (1) {\n                    switch (_context2.prev = _context2.next) {\n                        case 0:\n                            dotId = this.toDotId(rootNode);\n                            label = this.toLabel(rootNode.name);\n\n                            if (!VERBOSE) {\n                                _context2.next = 5;\n                                break;\n                            }\n\n                            _context2.next = 5;\n                            return indent + '# <drawCluster>';\n\n                        case 5:\n                            _context2.next = 7;\n                            return indent + 'subgraph cluster_' + dotId + ' {\\n' + indent + '  label=<' + _DOT.DOT.b(label) + '> style=\"' + style + '\"';\n\n                        case 7:\n                            _context2.next = 9;\n                            return '';\n\n                        case 9:\n                            _context2.next = 11;\n                            return indent + '  ' + dotId + ' [style=\"invisible\"]';\n\n                        case 11:\n                            _context2.next = 13;\n                            return '';\n\n                        case 13:\n                            return _context2.delegateYield(this.drawItems(rootNode.children, indent + INDENT), 't0', 14);\n\n                        case 14:\n                            _context2.next = 16;\n                            return indent + '}';\n\n                        case 16:\n                            if (rootNode.parentId) {\n                                _context2.next = 19;\n                                break;\n                            }\n\n                            nonClustered = this.graph.roots.filter(function (x) {\n                                return x !== rootNode.id;\n                            }).filter(function (x) {\n                                return x !== rootNode.parentId;\n                            });\n                            return _context2.delegateYield(this.drawItems(nonClustered, indent), 't1', 19);\n\n                        case 19:\n                            if (!VERBOSE) {\n                                _context2.next = 22;\n                                break;\n                            }\n\n                            _context2.next = 22;\n                            return indent + '# </drawCluster>';\n\n                        case 22:\n                        case 'end':\n                            return _context2.stop();\n                    }\n                }\n            }, drawCluster, this);\n        })\n    }, {\n        key: 'drawChildCluster',\n        value: /*#__PURE__*/regeneratorRuntime.mark(function drawChildCluster(indent, parentId) {\n            var _this4 = this;\n\n            var parent, dotId, label, nonClustered, otherChildren, nextIndent;\n            return regeneratorRuntime.wrap(function drawChildCluster$(_context3) {\n                while (1) {\n                    switch (_context3.prev = _context3.next) {\n                        case 0:\n                            parent = this.graph.idMap[parentId];\n                            dotId = this.toDotId(parent);\n                            label = this.toLabel(parent.name);\n                            nonClustered = this.graph.roots.filter(function (x) {\n                                return x !== parent.id;\n                            });\n                            otherChildren = parent.children.filter(function (x) {\n                                return x !== _this4.rootNode;\n                            });\n                            nextIndent = '' + indent + INDENT;\n\n                            if (!VERBOSE) {\n                                _context3.next = 9;\n                                break;\n                            }\n\n                            _context3.next = 9;\n                            return indent + '# <drawChildCluster>';\n\n                        case 9:\n                            _context3.next = 11;\n                            return indent + 'subgraph cluster_' + dotId + ' {';\n\n                        case 11:\n                            _context3.next = 13;\n                            return nextIndent + 'label=<' + _DOT.DOT.b(label) + '> style=\"rounded\"';\n\n                        case 13:\n                            _context3.next = 15;\n                            return '';\n\n                        case 15:\n                            _context3.next = 17;\n                            return '' + nextIndent + dotId + ' [style=\"invisible\"]';\n\n                        case 17:\n                            return _context3.delegateYield(this.drawItems(otherChildren, nextIndent), 't0', 18);\n\n                        case 18:\n                            _context3.next = 20;\n                            return '';\n\n                        case 20:\n                            return _context3.delegateYield(this.drawCluster(nextIndent, this.rootNode, 'solid'), 't1', 21);\n\n                        case 21:\n                            _context3.next = 23;\n                            return indent + '}';\n\n                        case 23:\n                            return _context3.delegateYield(this.drawItems(nonClustered, indent), 't2', 24);\n\n                        case 24:\n                            if (!VERBOSE) {\n                                _context3.next = 27;\n                                break;\n                            }\n\n                            _context3.next = 27;\n                            return indent + '# </drawChildCluster>';\n\n                        case 27:\n                        case 'end':\n                            return _context3.stop();\n                    }\n                }\n            }, drawChildCluster, this);\n        })\n    }, {\n        key: 'digraphHeaders',\n        value: /*#__PURE__*/regeneratorRuntime.mark(function digraphHeaders(indent) {\n            return regeneratorRuntime.wrap(function digraphHeaders$(_context4) {\n                while (1) {\n                    switch (_context4.prev = _context4.next) {\n                        case 0:\n                            _context4.next = 2;\n                            return indent + 'compound=true';\n\n                        case 2:\n                            if (!this.graph.title) {\n                                _context4.next = 9;\n                                break;\n                            }\n\n                            _context4.next = 5;\n                            return indent + 'label=\"' + this.toLabel(this.graph.title) + '\"';\n\n                        case 5:\n                            _context4.next = 7;\n                            return indent + 'fontsize=20';\n\n                        case 7:\n                            _context4.next = 9;\n                            return indent + 'labelloc=t';\n\n                        case 9:\n                            _context4.next = 11;\n                            return indent + 'node[fontsize=12]';\n\n                        case 11:\n                            _context4.next = 13;\n                            return indent + 'edge[fontsize=12]';\n\n                        case 13:\n                            _context4.next = 15;\n                            return '';\n\n                        case 15:\n                        case 'end':\n                            return _context4.stop();\n                    }\n                }\n            }, digraphHeaders, this);\n        })\n    }, {\n        key: 'toTechDescription',\n        value: function toTechDescription(text) {\n            if (!text) {\n                return '';\n            }\n            text = this.toDescription(text);\n            text = _DOT.DOT.font('#666666', _DOT.DOT.i('&#171;' + text + '&#187;'));\n            return '\\n<br/>\\n' + text + '\\n<br/>';\n        }\n    }, {\n        key: 'drawItems',\n        value: /*#__PURE__*/regeneratorRuntime.mark(function drawItems(nodesOrIds, indent) {\n            var _this5 = this;\n\n            return regeneratorRuntime.wrap(function drawItems$(_context5) {\n                while (1) {\n                    switch (_context5.prev = _context5.next) {\n                        case 0:\n                            if (!VERBOSE) {\n                                _context5.next = 3;\n                                break;\n                            }\n\n                            _context5.next = 3;\n                            return indent + '# <drawItems>';\n\n                        case 3:\n                            return _context5.delegateYield(nodesOrIds.map(function (x) {\n                                return (0, _lodash.isString)(x) ? _this5.graph.idMap[x] : x;\n                            }).filter(function (x) {\n                                return x.type !== 'edge';\n                            }).map(function (x) {\n                                return _this5.drawItem(x, indent);\n                            }), 't0', 4);\n\n                        case 4:\n                            if (!VERBOSE) {\n                                _context5.next = 7;\n                                break;\n                            }\n\n                            _context5.next = 7;\n                            return indent + '# </drawItems>';\n\n                        case 7:\n                        case 'end':\n                            return _context5.stop();\n                    }\n                }\n            }, drawItems, this);\n        })\n    }, {\n        key: 'drawItem',\n        value: function drawItem(node, indent) {\n            var dotId = this.toDotId(node);\n            var tech = this.toTechDescription(node.tech);\n            var desc = node.description ? '\\n<br/>\\n' + this.toDescription(node) : '';\n            var shape = typeShapeMap[node.type] || DEFAULT_SHAPE;\n            var attrs = {\n                shape: shape\n            };\n            var name = _DOT.DOT.b(node.name);\n            if (this.hrefTo && node.children && node.children.some(function (x) {\n                return x.type !== 'edge';\n            })) {\n                attrs.href = this.hrefTo(node.id);\n                attrs.tooltip = 'See more details about ' + node.name;\n                name = _DOT.DOT.font('blue', _DOT.DOT.u(name));\n            }\n            attrs.label = '<\\n' + name + tech + desc + '\\n' + indent + '>';\n            return '' + indent + dotId + ' ' + _DOT.DOT.attrList(attrs);\n        }\n    }, {\n        key: 'drawEdge',\n        value: function drawEdge(edge, indent) {\n            var _this6 = this;\n\n            var srcOk = this.isIdVisible(edge.sourceId);\n            var dstOk = this.isIdVisible(edge.destinationId);\n            var getId = function getId(idOk, id, parentIds) {\n                var result = idOk ? id : parentIds.find(function (x) {\n                    return _this6.isIdVisible(x);\n                });\n                if (result) {\n                    return result;\n                }\n                throw new Error('Unknown id');\n            };\n            var srcId = getId(srcOk, edge.sourceId, edge.sourceParentIds);\n            var dstId = getId(dstOk, edge.destinationId, edge.destinationParentIds);\n            var src = this.toDotId(srcId);\n            var dst = this.toDotId(dstId);\n            var attrs = {};\n            if (edge.description) {\n                attrs.label = this.toLabel(edge);\n            }\n            if (!(srcOk && dstOk)) {\n                attrs.style = 'dashed';\n            }\n            if (srcId === this.zoomNodeId) {\n                attrs.ltail = 'cluster_' + src;\n            }\n            if (dstId === this.zoomNodeId) {\n                attrs.lhead = 'cluster_' + dst;\n            }\n            attrs.dir = this.getEdgeDirection(edge.direction);\n            return '' + indent + src + ' -> ' + dst + ' ' + _DOT.DOT.attrList(attrs);\n        }\n    }, {\n        key: 'getEdgeDirection',\n        value: function getEdgeDirection(direction) {\n            switch (direction) {\n                case 'both':\n                    return 'both';\n                case 'pull':\n                    return 'back';\n                default:\n                    return null;\n            }\n        }\n    }]);\n\n    return DotContext;\n}();\n/**\n * build a DOT representation of the graph\n */\n\n\nvar toDot = exports.toDot = function toDot(graph, zoomNodeId, hrefTo) {\n    var ctx = new DotContext(hrefTo);\n    ctx.load(graph, zoomNodeId);\n    return ctx.draw();\n};\n\n/***/ }),\n\n/***/ 537:\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar DOT = exports.DOT = function () {\n    function DOT() {\n        _classCallCheck(this, DOT);\n    }\n\n    _createClass(DOT, null, [{\n        key: 'i',\n        value: function i(text) {\n            return '<i>' + text + '</i>';\n        }\n    }, {\n        key: 'b',\n        value: function b(text) {\n            return '<b>' + text + '</b>';\n        }\n    }, {\n        key: 'u',\n        value: function u(text) {\n            return '<u>' + text + '</u>';\n        }\n    }, {\n        key: 'font',\n        value: function font(color, text) {\n            return '<font color=\"' + color + '\">' + text + '</font>';\n        }\n    }, {\n        key: 'attrList',\n        value: function attrList(attrs) {\n            var dotAttrs = Reflect.ownKeys(attrs).filter(function (x) {\n                return attrs[x];\n            }).map(function (x) {\n                return x + '=' + DOT.quoteAttr(attrs[x]);\n            }).join(' ');\n            return '[' + dotAttrs + ']';\n        }\n    }, {\n        key: 'quoteAttr',\n        value: function quoteAttr(value) {\n            return (/^</.test(value) ? value : '\"' + value + '\"'\n            );\n        }\n    }]);\n\n    return DOT;\n}();\n\n/***/ }),\n\n/***/ 538:\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nvar readAllText = exports.readAllText = function readAllText(file) {\n    var reader = new FileReader();\n    return new Promise(function (resolve, reject) {\n        reader.onload = function (loadEvt) {\n            return resolve(loadEvt.target.result);\n        };\n        reader.onerror = reject;\n        reader.readAsText(file);\n    });\n};\n\n/***/ }),\n\n/***/ 539:\n/***/ (function(module, exports) {\n\nmodule.exports = \"<div class=\\\"modal-header\\\">\\n    <h3 class=\\\"modal-title\\\" id=\\\"modal-title\\\">About</h3>\\n</div>\\n<div class=\\\"modal-body\\\" id=\\\"modal-body\\\">\\n    <p>C4 Lab helps to create diagrams expressing a software architecture using a small lisp-like language, and share those\\n        diagrams as images or text.\\n    </p>\\n    <p>\\n        This is a based on <a href=\\\"http://www.simonbrown.je/\\\">Simon Brown</a>'s <a href=\\\"http://www.codingthearchitecture.com/2014/08/24/c4_model_poster.html\\\">C4</a>        approach: Context, Containers, Components, and Classes. See <a href=\\\"https://leanpub.com/visualising-software-architecture\\\">Visualising Software Architecture</a>        for more information.\\n    </p>\\n    <p>\\n        If you have any feedback or problems, please open a <a href=\\\"https://github.com/ryepup/c4-lab/issues\\\">issue on github</a>.\\n    </p>\\n    <c4-lab-build-info></c4-lab-build-info>\\n</div>\\n<div class=\\\"modal-footer\\\">\\n    <button class=\\\"btn btn-primary\\\" type=\\\"button\\\" ng-click=\\\"$ctrl.close()\\\">Close</button>\\n</div>\";\n\n/***/ }),\n\n/***/ 540:\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _app = __webpack_require__(541);\n\nObject.keys(_app).forEach(function (key) {\n  if (key === \"default\" || key === \"__esModule\") return;\n  Object.defineProperty(exports, key, {\n    enumerable: true,\n    get: function get() {\n      return _app[key];\n    }\n  });\n});\n\n/***/ }),\n\n/***/ 541:\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.options = exports.name = exports.AppController = undefined;\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }(); // TODO: don't need core, just look at redux\n\n\nvar _index = __webpack_require__(112);\n\nvar _gist = __webpack_require__(542);\n\nvar _app = __webpack_require__(578);\n\nvar _app2 = _interopRequireDefault(_app);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar AppController = exports.AppController = function () {\n    function AppController($log, $window, $ngRedux) {\n        'ngInject';\n\n        _classCallCheck(this, AppController);\n\n        this.log = $log;\n        this.$window = $window;\n        this.exporter = new _index.Exporter($window.document);\n        this.codeExpanded = true;\n\n        this.unsubscribe = $ngRedux.connect(this.mapStateToThis)(this);\n    }\n\n    _createClass(AppController, [{\n        key: '$onDestroy',\n        value: function $onDestroy() {\n            this.unsubscribe();\n        }\n    }, {\n        key: 'mapStateToThis',\n        value: function mapStateToThis(state) {\n            return { text: state.source, graph: state.graph, dot: state.dot };\n        }\n\n        /**\n         * calculate the base uri\n         *\n         * `$location.path()` gives the wrong value\n         */\n\n    }, {\n        key: 'onExport',\n        value: function onExport(format, href) {\n            var _this = this;\n\n            this.log.debug('Exporting as', format, href);\n            if (format === 'gist') {\n                var gist = new _gist.GistExporter();\n                // TODO: show a loading spinner or something while we wait\n                gist.export(this.graph.title, this.text, this.baseUri + href).then(function (result) {\n                    // TODO: show a modal with the link\n                    _this.$window.open(result.url, '_blank');\n                });\n            } else {\n                this.exporter.export(format, this.graph.title, this.text, this.dot);\n            }\n        }\n    }, {\n        key: 'baseUri',\n        get: function get() {\n            var l = this.$window.document.location;\n            return '' + l.origin + l.pathname;\n        }\n    }]);\n\n    return AppController;\n}();\n\nvar name = exports.name = \"c4LabApp\";\nvar options = exports.options = {\n    template: _app2.default,\n    controller: AppController\n};\n\n/***/ }),\n\n/***/ 542:\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.GistExporter = undefined;\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _githubApi = __webpack_require__(543);\n\nvar _githubApi2 = _interopRequireDefault(_githubApi);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction createReadme(title, url) {\n    return '# C4 Diagrams for *' + title + '*\\n\\nThese files were exported from [C4-Lab](https://ryepup.github.io/c4-lab)\\n\\n[View or edit these diagrams](' + url + ')\\n';\n}\n\nvar GistExporter = exports.GistExporter = function () {\n    function GistExporter() {\n        var gh = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : new _githubApi2.default();\n\n        _classCallCheck(this, GistExporter);\n\n        this.gh = gh;\n    }\n\n    _createClass(GistExporter, [{\n        key: 'export',\n        value: function _export(title, sexp, url) {\n            var gist = this.gh.getGist();\n            // TODO: use async/await\n            return gist.create({\n                description: 'C4 diagrams for \\'' + title + '\\'',\n                files: _defineProperty({\n                    'README.md': {\n                        content: createReadme(title, url)\n                    }\n                }, title + '.sexp', {\n                    content: sexp\n                }),\n                public: true\n            }).then(function (resp) {\n                return {\n                    id: resp.data.id,\n                    url: new URL(resp.data.html_url)\n                };\n            });\n        }\n    }]);\n\n    return GistExporter;\n}();\n\n/***/ }),\n\n/***/ 578:\n/***/ (function(module, exports) {\n\nmodule.exports = \"<c4-lab-nav on-export=\\\"$ctrl.onExport(format, href)\\\"></c4-lab-nav>\\n<div class=\\\"container-fluid\\\">\\n    <div class=\\\"row\\\">\\n        <div ng-class=\\\"$ctrl.codeExpanded ? 'col-md-6' : 'col-md-4'\\\">\\n            <c4-lab-editor></c4-lab-editor>\\n\\n            <button class=\\\"btn btn-default btn-block\\\" type=\\\"button\\\" ng-click=\\\"$ctrl.codeExpanded = !$ctrl.codeExpanded\\\">\\n                <span class=\\\"glyphicon\\\" ng-class=\\\"$ctrl.codeExpanded ? 'glyphicon-chevron-left' : 'glyphicon-chevron-right'\\\"></span>\\n                Show {{$ctrl.codeExpanded ? 'less' : 'more'}} code\\n            </button>\\n        </div>\\n        <div ng-class=\\\"$ctrl.codeExpanded ? 'col-md-6' : 'col-md-8'\\\">\\n            <c4-lab-viewer></c4-lab-viewer>\\n        </div>\\n    </div>\\n</div>\";\n\n/***/ }),\n\n/***/ 579:\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.options = exports.name = undefined;\n\nvar _template = __webpack_require__(580);\n\nvar _template2 = _interopRequireDefault(_template);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar BuildInfoController = function BuildInfoController() {\n    _classCallCheck(this, BuildInfoController);\n\n    /* global process */\n    this.version = \"0.35.0\";\n    this.build = null || 'SNAPSHOT';\n    this.hash = null || null || 'HEAD';\n};\n\nvar name = exports.name = 'c4LabBuildInfo';\nvar options = exports.options = {\n    template: _template2.default,\n    controller: BuildInfoController\n};\n\n/***/ }),\n\n/***/ 580:\n/***/ (function(module, exports) {\n\nmodule.exports = \"<span class=\\\"text-muted small\\\" title=\\\"{{$ctrl.hash}}\\\">\\n  v{{$ctrl.version}}+{{$ctrl.build}}\\n</span>\\n\";\n\n/***/ }),\n\n/***/ 581:\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _actions = __webpack_require__(60);\n\nfunction configureRoutes($stateProvider, $urlRouterProvider) {\n  'ngInject';\n\n  $urlRouterProvider.otherwise('/');\n  $stateProvider.state('home', {\n    url: '/?zoom',\n    component: 'c4LabApp',\n    resolve: {\n      zoom: function zoom($stateParams) {\n        return $stateParams.zoom;\n      }\n    },\n    onEnter: function onEnter(zoom, $ngRedux) {\n      var currentZoom = $ngRedux.getState().zoomNodeId;\n      if (currentZoom !== zoom) {\n        $ngRedux.dispatch((0, _actions.zoomChanged)({ zoomNodeId: zoom }));\n      }\n    }\n  }).state('load', {\n    url: '/load/{data}?zoom',\n    component: 'c4LabPreview',\n    resolve: {\n      encodedText: function encodedText($stateParams) {\n        return $stateParams.data;\n      },\n      zoom: function zoom($stateParams) {\n        return $stateParams.zoom;\n      }\n    },\n    onEnter: function onEnter(zoom, $ngRedux) {\n      // TODO: dedupe with other endpoint\n      var currentZoom = $ngRedux.getState().zoomNodeId;\n      if (currentZoom !== zoom) {\n        $ngRedux.dispatch((0, _actions.zoomChanged)({ zoomNodeId: zoom }));\n      }\n    }\n\n  }).state('help', {\n    url: '/help',\n    component: 'c4LabHelp'\n  });\n}\n\nexports.default = configureRoutes;\n\n/***/ }),\n\n/***/ 582:\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _angular = __webpack_require__(41);\n\nvar angular = _interopRequireWildcard(_angular);\n\nvar _preview = __webpack_require__(583);\n\nvar previewComponent = _interopRequireWildcard(_preview);\n\nvar _header = __webpack_require__(231);\n\nvar _header2 = _interopRequireDefault(_header);\n\nvar _viewer = __webpack_require__(244);\n\nvar _viewer2 = _interopRequireDefault(_viewer);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj.default = obj; return newObj; } }\n\nexports.default = angular.module('c4-lab.preview', [_header2.default, _viewer2.default]).component(previewComponent.name, previewComponent.options).name;\n\n/***/ }),\n\n/***/ 583:\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.options = exports.name = undefined;\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n// TODO: don't need core, just look at redux\n\n\nvar _preview = __webpack_require__(584);\n\nvar _preview2 = _interopRequireDefault(_preview);\n\nvar _index = __webpack_require__(112);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar PreviewComponent = function () {\n    function PreviewComponent($window, $state) {\n        _classCallCheck(this, PreviewComponent);\n\n        this.exporter = new _index.Exporter($window.document);\n        this.storage = new _index.DataStore($window.localStorage);\n        this.$state = $state;\n    }\n\n    _createClass(PreviewComponent, [{\n        key: '$onChanges',\n        value: function $onChanges() {\n            this.text = (0, _index.uriDecode)(this.encodedText);\n            this.graph = (0, _index.parse)(this.text);\n        }\n    }, {\n        key: 'onExport',\n        value: function onExport(format) {\n            this.exporter.export(format, this.graph.title, this.text, this.dot);\n        }\n    }, {\n        key: 'edit',\n        value: function edit() {\n            this.storage.save(this.text);\n            this.$state.go('home');\n        }\n    }]);\n\n    return PreviewComponent;\n}();\n\nvar name = exports.name = 'c4LabPreview';\nvar options = exports.options = {\n    template: _preview2.default,\n    controller: PreviewComponent,\n    bindings: {\n        zoom: '<',\n        encodedText: '<'\n    }\n};\n\n/***/ }),\n\n/***/ 584:\n/***/ (function(module, exports) {\n\nmodule.exports = \"<c4-lab-nav text=\\\"$ctrl.text\\\" on-export=\\\"$ctrl.onExport(format)\\\" zoom=\\\"$ctrl.zoom\\\"></c4-lab-nav>\\n<c4-lab-viewer graph=\\\"$ctrl.graph\\\" zoom=\\\"$ctrl.zoom\\\" ng-model=\\\"$ctrl.dot\\\">\\n    <button type=\\\"button\\\" class=\\\"btn btn-primary hidden-xs hidden-sm\\\" ng-click=\\\"$ctrl.edit()\\\">Start editing this graph</button>\\n</c4-lab-viewer>\";\n\n/***/ }),\n\n/***/ 585:\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.options = exports.name = undefined;\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _viewer = __webpack_require__(586);\n\nvar _viewer2 = _interopRequireDefault(_viewer);\n\nvar _actions = __webpack_require__(60);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar ViewerComponent = function () {\n    function ViewerComponent($log, $sce, $ngRedux) {\n        'ngInject';\n\n        _classCallCheck(this, ViewerComponent);\n\n        this.$log = $log;\n        this.$sce = $sce;\n\n        this.unsubscribe = $ngRedux.connect(this.mapStateToThis.bind(this), { zoomChanged: _actions.zoomChanged })(this);\n    }\n\n    _createClass(ViewerComponent, [{\n        key: '$onDestroy',\n        value: function $onDestroy() {\n            this.unsubscribe();\n        }\n    }, {\n        key: 'mapStateToThis',\n        value: function mapStateToThis(state) {\n            return {\n                expandableNodes: state.zoomableNodes,\n                graph: state.graph,\n                zoom: state.zoomNodeId,\n                dot: state.dot,\n                svg: this.$sce.trustAsHtml(state.svg)\n            };\n        }\n    }, {\n        key: 'onZoom',\n        value: function onZoom() {\n            this.zoomChanged({ zoomNodeId: this.zoom });\n        }\n    }]);\n\n    return ViewerComponent;\n}();\n\nvar name = exports.name = 'c4LabViewer';\nvar options = exports.options = {\n    transclude: true,\n    template: _viewer2.default,\n    controller: ViewerComponent\n};\n\n/***/ }),\n\n/***/ 586:\n/***/ (function(module, exports) {\n\nmodule.exports = \"<div>\\n    <form class=\\\"form-inline\\\">\\n        <div class=\\\"form-group\\\">\\n            <label for=\\\"zoomableNodes\\\">Zoom to node</label>\\n            <select name=\\\"zoomableNodes\\\" class=\\\"form-control\\\" ng-model=\\\"$ctrl.zoom\\\" ng-change=\\\"$ctrl.onZoom()\\\">\\n                <option ng-value=\\\"undefined\\\">--none--</option>\\n                <option ng-repeat=\\\"node in $ctrl.expandableNodes track by node.id\\\"\\n                    value=\\\"{{node.id}}\\\">{{node.path}}</option>\\n            </select>\\n        </div>\\n        <div class=\\\"form-group\\\" ng-transclude>\\n        </div>\\n    </form>\\n    <uib-tabset>\\n        <uib-tab heading=\\\"svg\\\">\\n            <div ng-bind-html=\\\"$ctrl.svg\\\"></div>\\n        </uib-tab>\\n        <uib-tab heading=\\\"dot\\\">\\n            <p>This is for debugging purposes</p>\\n            <!-- TODO: a disabled text area -->\\n            <pre>{{$ctrl.dot}}</pre>\\n        </uib-tab>\\n    </uib-tabset>\\n    <div>\";\n\n/***/ }),\n\n/***/ 587:\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _angular = __webpack_require__(41);\n\nvar angular = _interopRequireWildcard(_angular);\n\nvar _help = __webpack_require__(588);\n\nvar _help2 = _interopRequireDefault(_help);\n\nvar _help3 = __webpack_require__(589);\n\nvar _help4 = _interopRequireDefault(_help3);\n\n__webpack_require__(590);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj.default = obj; return newObj; } }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar HelpController = function HelpController() {\n    _classCallCheck(this, HelpController);\n\n    this.content = _help4.default;\n};\n\nexports.default = angular.module('c4-lab.help', ['hc.marked']).component('c4LabHelp', {\n    template: _help2.default,\n    controller: HelpController\n}).name;\n\n/***/ }),\n\n/***/ 588:\n/***/ (function(module, exports) {\n\nmodule.exports = \"<c4-lab-nav></c4-lab-nav>\\n<div marked=\\\"$ctrl.content\\\"></div>\";\n\n/***/ }),\n\n/***/ 589:\n/***/ (function(module, exports) {\n\nmodule.exports = \"# C4-Lab Help\\n\\nC4-Lab defines a domain specific language (DSL) for creating software\\narchitectures, modeled heavily after [Simon Brown][SB]'s [C4][] approach\\n(Context, Containers, Components, and Classes). See [Visualising Software\\nArchitecture][] for more information.\\n\\n[SB]: http://www.simonbrown.je/\\n[C4]: http://www.codingthearchitecture.com/2014/08/24/c4_model_poster.html\\n[Visualising Software Architecture]: https://leanpub.com/visualising-software-architecture\\n\\n## Features\\n\\nC4-Lab has import, export, and \\\"share\\\" features accessible in the top\\nnavigation, and saves work-in-progress in your browser.  If you want to save a\\ngraph for later editing, export the `sexp` format, or save the \\\"share\\\" link.\\nOther exports do not allow resuming editing.\\n\\n## Syntax\\n\\nThe DSL uses [s-expression][]s to represent the hierarchy and connections\\nbetween actors, systems, containers, and components. If you squint your eyes, it\\nlooks like common lisp or scheme macros.\\n\\nWe use the excellent [CodeMirror][] in-browser editor to add syntax highlighting\\nand some help with managing the parentheses.\\n\\n[CodeMirror]: https://codemirror.net/\\n[s-expression]: https://en.wikipedia.org/wiki/S-expression\\n\\n### Full example\\n\\nHere's a small bit of software archicture for a web application, demonstrating\\nsome of the syntax.\\n\\n    (define-actor (\\\"customer\\\")\\n      (edge :to \\\"dog rater\\\" :description \\\"views/votes/uploads dog pictures\\\"))\\n\\n    (define-system (\\\"dog rater\\\" :desc \\\"fun clickbait website\\\")\\n\\n      (def-container (\\\"frontend\\\" :tech \\\"typescript, reactjs\\\")\\n        (edge :to \\\"./database\\\" :desc \\\"display sweet dog pictures\\\" \\n              :direction \\\"both\\\")\\n        )\\n\\n      (def-container (\\\"backend\\\" :tech \\\"golang\\\")\\n        (def-component (\\\"ad provider\\\")\\n          (edge :to \\\"third party ad network\\\" :desc \\\"fetch user-specific ads\\\")\\n          )\\n        )\\n\\n      (def-container (\\\"database\\\" :tech \\\"amazon S3\\\"))\\n    )\\n\\n    (def-system (\\\"third party ad network\\\" :desc \\\"advert network\\\"))\\n\\n### Actors\\n\\nTop level element, represents a human using the software.\\n\\nExamples:\\n\\n    (define-actor (\\\"customer\\\")\\n      ;; optional edges to other parts of the architecture\\n      )\\n\\nIf this were a real lisp macro, it's definition would look like:\\n\\n    (defmacro define-actor ((name) &body children))\\n\\n### Systems\\n\\nTop level element, represents a logical software system.\\n\\nExamples:\\n\\n    (define-system (\\\"name of the system\\\" :description \\\"optional description\\\" \\n                                         :tech \\\"optional technology\\\")\\n      ;; optional children of this system; edges or containers\\n      )\\n    (def-system (\\\"name of the system\\\" :desc \\\"can abbreviate a little; :desc vs :description, def-system vs define-system\\\"))\\n\\nIf this were a real lisp macro, it's definition would look like:\\n\\n    (defmacro define-system ((name) &key description tech &body children))\\n\\n### Containers\\n\\nContainers are independently deployable pieces of a system. They should be used as children of a `def-system`\\n\\nExamples:\\n\\n    (def-system (\\\"dog ratr\\\")\\n      (def-container (\\\"frontend\\\" :tech \\\"...\\\" :desc \\\"...\\\")\\n        ;; optional children of this system; edges or components\\n      )\\n    )\\n\\nIf this were a real lisp macro, it's definition would look like:\\n\\n    (defmacro define-container ((name) &key description tech &body children))\\n\\n### Components\\n\\nComponents are pieces of one deployable part of a system. These could be things\\nlike java packages, C# assemblies, ES6 modules, etc. They should be used as\\nchildren of a `def-container`\\n\\nExamples:\\n\\n    (def-system (\\\"dog ratr\\\")\\n      (def-container (\\\"frontend\\\")\\n        (def-component (\\\"upload page\\\" :tech \\\"...\\\" :desc \\\"...\\\"))\\n        (def-component (\\\"dog browser\\\")\\n          ;; optional children, edges\\n        )\\n      )\\n    )\\n\\nIf this were a real lisp macro, it's definition would look like:\\n\\n    (defmacro define-component ((name) &key description tech &body children))\\n\\n### Edges\\n\\nEdges represent connections between the different elements in a software\\narchitecture. These have a few different options for how to connect things.\\nConnections are specified using something like a file path to unambiguously\\nidentify the destination of an edge.\\n\\nThey can be used as children of `def-actor`, `def-system`, `def-container`, and\\n`def-component`.\\n\\nYou can customize the direction of the edge using the `:direction` (`:dir` for\\nshort) option. The valid options are:\\n\\n* `push` - (default), indicates this node is reaching out to the target. Draws\\n  an arrow from the current node to the target.\\n* `pull` - indicates this node is pulling from the target, e.g. as a subscriber.\\n  Draws an arrow from the target to the current node.\\n* `both` - indicates bidrectional flow of actions/information. Draws an arrow to\\n  and from the target to the current node.\\n\\nExamples:\\n\\n    (def-actor (\\\"customer\\\")\\n      ;; connect this actor to the dog ratr system, and describe\\n      ;; how the actor uses the system\\n      (edge :to \\\"dog ratr\\\" :desc \\\"clicks a lot of links and ads\\\"))\\n\\n    (def-system (\\\"dog ratr\\\")\\n      (def-container (\\\"frontend\\\")\\n        ;; connect the frontend to the backend, with a relative path\\n        (edge :to \\\"./backend\\\" :desc \\\"fetch list of dogs\\\" :dir \\\"both\\\")\\n        ;; can specify a \\\"full\\\" path to connect with nodes that aren't\\n        ;; on the top level\\n        (edge :to \\\"ad server/click tracker\\\" :desc \\\"records a click via HTTP\\\")\\n      )\\n      (def-container (\\\"backend\\\"))\\n    )\\n\\n    (def-system (\\\"ad server\\\")\\n      (def-container (\\\"click tracker\\\")))\\n\\nIf this were a real lisp function, it's definition would look like:\\n\\n    (defun edge (&key to description (direction \\\"both\\\")))\\n\\n### Comments\\n\\nComments are of questionable use since they don't show up in the diagrams at\\nall, but they are useful for commenting out code while you're still hasing out\\nthe architecture.\\n\\nAny content after two colons is ignored as a comment.\\n\\nExamples:\\n\\n    ;; this whole line is a comment\\n    (def-system (\\\"dog ratr\\\")) ;; this bit is ignored, too\\n\"\n\n/***/ }),\n\n/***/ 593:\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _angular = __webpack_require__(41);\n\nvar angular = _interopRequireWildcard(_angular);\n\n__webpack_require__(594);\n\nvar _reduxSaga = __webpack_require__(663);\n\nvar _reduxSaga2 = _interopRequireDefault(_reduxSaga);\n\nvar _reducers = __webpack_require__(669);\n\nvar _reducers2 = _interopRequireDefault(_reducers);\n\nvar _sagas = __webpack_require__(672);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj.default = obj; return newObj; } }\n\nvar timingMiddleware = function timingMiddleware(store) {\n    return function (next) {\n        return function (action) {\n            // tslint:disable:no-console\n            var label = 'Processing ' + action.type;\n            console.time(label);\n            console.group(label);\n            try {\n                return next(action);\n            } finally {\n                console.timeEnd(label);\n                console.groupEnd();\n            }\n            // tslint:enable:no-console\n        };\n    };\n};\n// tslint:disable-next-line:ban-types\nvar enhancers = [];\nvar reduxDevtool = window.__REDUX_DEVTOOLS_EXTENSION__;\nif (reduxDevtool) {\n    enhancers.push(reduxDevtool());\n}\nvar sagas = (0, _reduxSaga2.default)();\nexports.default = angular.module('c4-lab.store', ['ngRedux']).config(function ($ngReduxProvider) {\n    $ngReduxProvider.createStoreWith(_reducers2.default, [timingMiddleware, sagas], enhancers);\n}).run(function ($ngRedux) {\n    sagas.run(_sagas.rootSaga);\n}).name;\n\n/***/ }),\n\n/***/ 60:\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.zoomChanged = exports.angularInitialized = exports.svgChanged = exports.dotChanged = exports.sourceChanged = exports.sourceParseError = exports.sourceParsed = undefined;\n\nvar _typescriptFsa = __webpack_require__(230);\n\nvar _typescriptFsa2 = _interopRequireDefault(_typescriptFsa);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar actionCreator = (0, _typescriptFsa2.default)();\nvar sourceParsed = exports.sourceParsed = actionCreator('C4_SOURCE_PARSED');\nvar sourceParseError = exports.sourceParseError = actionCreator('C4_SOURCE_PARSE_ERROR');\nvar sourceChanged = exports.sourceChanged = actionCreator('C4_SOURCE_CHANGED');\nvar dotChanged = exports.dotChanged = actionCreator('C4_DOT_CHANGED');\nvar svgChanged = exports.svgChanged = actionCreator('C4_SVG_CHANGED');\nvar angularInitialized = exports.angularInitialized = actionCreator('C4_ANGULAR_INITIALIZED');\nvar zoomChanged = exports.zoomChanged = actionCreator('C4_ZOOM_CHANGED');\n\n/***/ }),\n\n/***/ 61:\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nfunction _extendableBuiltin(cls) {\n  function ExtendableBuiltin() {\n    var instance = Reflect.construct(cls, Array.from(arguments));\n    Object.setPrototypeOf(instance, Object.getPrototypeOf(this));\n    return instance;\n  }\n\n  ExtendableBuiltin.prototype = Object.create(cls.prototype, {\n    constructor: {\n      value: cls,\n      enumerable: false,\n      writable: true,\n      configurable: true\n    }\n  });\n\n  if (Object.setPrototypeOf) {\n    Object.setPrototypeOf(ExtendableBuiltin, cls);\n  } else {\n    ExtendableBuiltin.__proto__ = cls;\n  }\n\n  return ExtendableBuiltin;\n}\n\nvar ParseError = function (_extendableBuiltin2) {\n  _inherits(ParseError, _extendableBuiltin2);\n\n  function ParseError() {\n    _classCallCheck(this, ParseError);\n\n    return _possibleConstructorReturn(this, (ParseError.__proto__ || Object.getPrototypeOf(ParseError)).apply(this, arguments));\n  }\n\n  return ParseError;\n}(_extendableBuiltin(Error));\n\nexports.default = ParseError;\n\n/***/ }),\n\n/***/ 669:\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.initialState = undefined;\n\nvar _redux = __webpack_require__(256);\n\nvar _typescriptFsaReducers = __webpack_require__(670);\n\nvar _actions = __webpack_require__(60);\n\nvar _c4lab = __webpack_require__(671);\n\nvar _c4lab2 = _interopRequireDefault(_c4lab);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar initialState = exports.initialState = {\n    graph: null,\n    parseError: null,\n    source: _c4lab2.default,\n    zoomNodeId: null,\n    zoomableNodes: []\n};\nvar sourceReducer = (0, _typescriptFsaReducers.reducerWithInitialState)(_c4lab2.default).case(_actions.sourceChanged, function (old, evt) {\n    return evt.source;\n}).build();\n// TODO: not need this; there's gotta be some config to teach jest's\n// typescript preprocessor to respect the additional types\nvar testSafeSourceReducer = function testSafeSourceReducer(src, evt) {\n    return sourceReducer(src, evt) || '';\n};\nvar parseErrorReducer = (0, _typescriptFsaReducers.reducerWithInitialState)(null).case(_actions.sourceParseError, function (old, evt) {\n    return evt.error;\n}).case(_actions.sourceParsed, function (old, evt) {\n    return null;\n}).build();\nvar graphReducer = (0, _typescriptFsaReducers.reducerWithInitialState)(null).case(_actions.sourceParsed, function (old, evt) {\n    return evt.graph;\n}).build();\nvar zoomableNodesReducer = (0, _typescriptFsaReducers.reducerWithInitialState)([]).case(_actions.sourceParsed, function (old, evt) {\n    return evt.graph.items.filter(function (x) {\n        return x.canExpand;\n    }).sort(function (a, b) {\n        return a.path.localeCompare(b.path);\n    });\n}).build();\nvar zoomNodeIdReducer = (0, _typescriptFsaReducers.reducerWithInitialState)(null).case(_actions.zoomChanged, function (old, evt) {\n    return evt.zoomNodeId || null;\n}).build();\nvar dotReducer = (0, _typescriptFsaReducers.reducerWithInitialState)(null).case(_actions.dotChanged, function (old, evt) {\n    return evt.dot;\n}).build();\nvar svgReducer = (0, _typescriptFsaReducers.reducerWithInitialState)(null).case(_actions.svgChanged, function (old, evt) {\n    return evt.svg;\n}).build();\nvar stateReducer = (0, _typescriptFsaReducers.reducerWithInitialState)(null).case(_actions.angularInitialized, function (old, evt) {\n    return evt.$state;\n}).build();\nvar windowReducer = (0, _typescriptFsaReducers.reducerWithInitialState)(null).case(_actions.angularInitialized, function (old, evt) {\n    return evt.$window;\n}).build();\nvar rootReducer = (0, _redux.combineReducers)({\n    $state: stateReducer,\n    $window: windowReducer,\n    dot: dotReducer,\n    graph: graphReducer,\n    parseError: parseErrorReducer,\n    source: testSafeSourceReducer,\n    svg: svgReducer,\n    zoomNodeId: zoomNodeIdReducer,\n    zoomableNodes: zoomableNodesReducer\n});\nexports.default = rootReducer;\n\n/***/ }),\n\n/***/ 671:\n/***/ (function(module, exports) {\n\nmodule.exports = \"(title \\\"c4-lab\\\")\\n;; add an actor to represent humans that use your system\\n(define-actor (\\\"Devs\\\")\\n  ;; add edges to say what part of your system the actor uses\\n  (edge\\n   ;; specify where the other end of this edge is using something like a path\\n   ;; \\\"C4 Lab/UI\\\" points at the \\\"C4 Lab\\\" system, the the \\\"UI\\\" container inside\\n   :to \\\"C4 Lab/UI\\\"\\n   :description \\\"Create/read/update designs\\\")\\n  )\\n;; add your system\\n(define-system (\\\"C4 Lab\\\"\\n                :description \\\"Web-based rapid prototyping of C4 diagrams to augment whiteboards\\\")\\n  ;; add the containers inside your system\\n  (def-container (\\\"UI\\\" :tech \\\"html5, angularjs\\\"\\n                       :description \\\"prototype, import, export C4 diagrams\\\" ))\\n  )\\n(define-system (\\\"Github\\\" :description \\\"Free git and web hosting\\\")\\n  ;; add edges between any actor, system, or container\\n  (edge :description \\\"hosts\\\" :to \\\"C4 Lab/UI\\\")\\n  (edge :to \\\"Travis-ci\\\" :description \\\"triggers build\\\")\\n  )\\n(define-system (\\\"Travis-ci\\\" :description \\\"Open source CI\\\")\\n  (edge :to \\\"Github\\\" :description \\\"publishes\\\"))\\n;; any line that starts with \\\";;\\\" is a comment\\n\"\n\n/***/ }),\n\n/***/ 672:\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.rootSaga = rootSaga;\n\nvar _effects = __webpack_require__(266);\n\nvar _core = __webpack_require__(112);\n\nvar _actions = __webpack_require__(60);\n\nvar _marked = /*#__PURE__*/regeneratorRuntime.mark(onSourceChanged),\n    _marked2 = /*#__PURE__*/regeneratorRuntime.mark(render),\n    _marked3 = /*#__PURE__*/regeneratorRuntime.mark(updateZoom),\n    _marked4 = /*#__PURE__*/regeneratorRuntime.mark(latestSource),\n    _marked5 = /*#__PURE__*/regeneratorRuntime.mark(latestGraph),\n    _marked6 = /*#__PURE__*/regeneratorRuntime.mark(latestZoom),\n    _marked7 = /*#__PURE__*/regeneratorRuntime.mark(init),\n    _marked8 = /*#__PURE__*/regeneratorRuntime.mark(rootSaga);\n\nfunction onSourceChanged(action) {\n    var graph;\n    return regeneratorRuntime.wrap(function onSourceChanged$(_context) {\n        while (1) {\n            switch (_context.prev = _context.next) {\n                case 0:\n                    _context.prev = 0;\n                    graph = (0, _core.parse)(action.payload.source);\n                    _context.next = 4;\n                    return (0, _effects.put)((0, _actions.sourceParsed)({ graph: graph }));\n\n                case 4:\n                    _context.next = 10;\n                    break;\n\n                case 6:\n                    _context.prev = 6;\n                    _context.t0 = _context['catch'](0);\n                    _context.next = 10;\n                    return (0, _effects.put)((0, _actions.sourceParseError)({ error: _context.t0.message }));\n\n                case 10:\n                case 'end':\n                    return _context.stop();\n            }\n        }\n    }, _marked, this, [[0, 6]]);\n}\nfunction hrefTo($state, zoom) {\n    var name = $state.current.name;\n    if (name === undefined) {\n        return '';\n    }\n    var params = Object.assign({}, $state.params, { zoom: zoom });\n    return $state.href(name, params);\n}\nfunction render() {\n    var _ref, zoomNodeId, graph, $state, $window, source, dot, svg;\n\n    return regeneratorRuntime.wrap(function render$(_context2) {\n        while (1) {\n            switch (_context2.prev = _context2.next) {\n                case 0:\n                    _context2.next = 2;\n                    return (0, _effects.select)();\n\n                case 2:\n                    _ref = _context2.sent;\n                    zoomNodeId = _ref.zoomNodeId;\n                    graph = _ref.graph;\n                    $state = _ref.$state;\n                    $window = _ref.$window;\n                    source = _ref.source;\n\n                    new _core.DataStore($window.localStorage).save(source);\n                    // TODO: resolve race condition where we call this method before $state.current exists\n                    // so we can drop this wait\n\n                case 9:\n                    if ($state.current && $state.current.name) {\n                        _context2.next = 14;\n                        break;\n                    }\n\n                    _context2.next = 12;\n                    return (0, _effects.call)(wait);\n\n                case 12:\n                    _context2.next = 9;\n                    break;\n\n                case 14:\n                    dot = (0, _core.toDot)(graph, zoomNodeId, function (x) {\n                        return hrefTo($state, x);\n                    });\n                    _context2.next = 17;\n                    return (0, _effects.put)((0, _actions.dotChanged)({ dot: dot }));\n\n                case 17:\n                    svg = (0, _core.toSvg)(dot);\n                    _context2.next = 20;\n                    return (0, _effects.put)((0, _actions.svgChanged)({ svg: svg }));\n\n                case 20:\n                case 'end':\n                    return _context2.stop();\n            }\n        }\n    }, _marked2, this);\n}\nfunction wait() {\n    var ms = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 50;\n\n    return new Promise(function (resolve) {\n        return setTimeout(resolve, ms);\n    });\n}\nfunction updateZoom(action) {\n    var _ref2, $state, zoom, name, params;\n\n    return regeneratorRuntime.wrap(function updateZoom$(_context3) {\n        while (1) {\n            switch (_context3.prev = _context3.next) {\n                case 0:\n                    _context3.next = 2;\n                    return (0, _effects.select)();\n\n                case 2:\n                    _ref2 = _context3.sent;\n                    $state = _ref2.$state;\n                    zoom = action.payload.zoomNodeId;\n\n                    if (!(zoom === $state.params.zoom)) {\n                        _context3.next = 7;\n                        break;\n                    }\n\n                    return _context3.abrupt('return');\n\n                case 7:\n                    _context3.next = 9;\n                    return (0, _effects.call)(render);\n\n                case 9:\n                    name = $state.current.name;\n\n                    if (name) {\n                        params = Object.assign({}, $state.params, { zoom: zoom });\n\n                        $state.go(name, params, { notify: false });\n                    }\n\n                case 11:\n                case 'end':\n                    return _context3.stop();\n            }\n        }\n    }, _marked3, this);\n}\nfunction latestSource() {\n    return regeneratorRuntime.wrap(function latestSource$(_context4) {\n        while (1) {\n            switch (_context4.prev = _context4.next) {\n                case 0:\n                    _context4.next = 2;\n                    return (0, _effects.takeLatest)(_actions.sourceChanged, onSourceChanged);\n\n                case 2:\n                case 'end':\n                    return _context4.stop();\n            }\n        }\n    }, _marked4, this);\n}\nfunction latestGraph() {\n    return regeneratorRuntime.wrap(function latestGraph$(_context5) {\n        while (1) {\n            switch (_context5.prev = _context5.next) {\n                case 0:\n                    _context5.next = 2;\n                    return (0, _effects.takeLatest)(_actions.sourceParsed, render);\n\n                case 2:\n                case 'end':\n                    return _context5.stop();\n            }\n        }\n    }, _marked5, this);\n}\nfunction latestZoom() {\n    return regeneratorRuntime.wrap(function latestZoom$(_context6) {\n        while (1) {\n            switch (_context6.prev = _context6.next) {\n                case 0:\n                    _context6.next = 2;\n                    return (0, _effects.throttle)(100, _actions.zoomChanged, updateZoom);\n\n                case 2:\n                case 'end':\n                    return _context6.stop();\n            }\n        }\n    }, _marked6, this);\n}\nfunction init() {\n    var _ref3, $window, storage, source;\n\n    return regeneratorRuntime.wrap(function init$(_context7) {\n        while (1) {\n            switch (_context7.prev = _context7.next) {\n                case 0:\n                    _context7.next = 2;\n                    return (0, _effects.take)(_actions.angularInitialized.type);\n\n                case 2:\n                    _context7.next = 4;\n                    return (0, _effects.select)();\n\n                case 4:\n                    _ref3 = _context7.sent;\n                    $window = _ref3.$window;\n\n                    if ($window.localStorage) {\n                        _context7.next = 8;\n                        break;\n                    }\n\n                    return _context7.abrupt('return');\n\n                case 8:\n                    // TODO: hack to make tests happy\n                    storage = new _core.DataStore($window.localStorage);\n                    source = storage.load();\n\n                    if (!source) {\n                        _context7.next = 13;\n                        break;\n                    }\n\n                    _context7.next = 13;\n                    return (0, _effects.put)((0, _actions.sourceChanged)({ source: source }));\n\n                case 13:\n                case 'end':\n                    return _context7.stop();\n            }\n        }\n    }, _marked7, this);\n}\nfunction rootSaga() {\n    return regeneratorRuntime.wrap(function rootSaga$(_context8) {\n        while (1) {\n            switch (_context8.prev = _context8.next) {\n                case 0:\n                    _context8.next = 2;\n                    return (0, _effects.all)([(0, _effects.call)(latestSource), (0, _effects.call)(latestGraph), (0, _effects.call)(latestZoom), (0, _effects.call)(init)]);\n\n                case 2:\n                case 'end':\n                    return _context8.stop();\n            }\n        }\n    }, _marked8, this);\n}\n\n/***/ })\n\n},[267]);\n\n\n// WEBPACK FOOTER //\n// main.368d9959f9ac769b7bff.js","export { parse, SyntaxError, ParseError } from './parse/index'\nexport { uriEncode, uriDecode, toSvg } from './codegen'\nexport { DataStore } from './DataStore'\nexport { Exporter, formats } from './exporter'\nexport { toDot } from './dot-writer'\n\n\n\n// WEBPACK FOOTER //\n// ./node_modules/source-map-loader!./node_modules/tslint-loader!./src/core/index.ts","import angular from 'angular'\nimport * as nav from \"./nav.component\"\nimport * as about from \"./about.component\"\n\nexport default angular.module('c4-lab.header', [\n    'ui.bootstrap',\n    'ui.router'])\n    .component(nav.name, nav.options)\n    .component(about.name, about.options)\n    .name\n\n\n// WEBPACK FOOTER //\n// ./src/header/index.js","import ParseError from './ParseError'\n\nexport default class InvalidDirectionError extends ParseError {\n    constructor(dir: string) {\n        super(`Unknown edge direction \"${dir}\". valid options are \"push\", \"pull\", or \"both\"`)\n    }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./node_modules/source-map-loader!./node_modules/tslint-loader!./src/core/parse/InvalidDirectionError.ts","import ParseError from './ParseError'\n\nexport default class OptsNotFoundError extends ParseError {\n    constructor(type: string) { super(`missing options for a ${type}`) }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./node_modules/source-map-loader!./node_modules/tslint-loader!./src/core/parse/OptsNotFoundError.ts","import ParseError from './ParseError'\n\nexport default class NameNotFoundError extends ParseError {\n    constructor(type: string) { super(`missing a name for a ${type}`) }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./node_modules/source-map-loader!./node_modules/tslint-loader!./src/core/parse/NameNotFoundError.ts","import * as lz from 'lz-string'\nimport Viz from 'viz.js'\n\ntype elementCreator = (tagName: string) => HTMLElement\n\n/**\n * convert a graph from DOT text to SVG\n */\nexport const toSvg = (dot: string) => Viz(dot, { format: 'svg', engine: 'dot' }) as string\n\n/**\n * convert a text representation to an URI-encoded representation\n */\nexport const uriEncode = (text: string) => lz.compressToEncodedURIComponent(text)\n\n/**\n * convert an URI-encoded representation to a text representation\n */\nexport const uriDecode = (uriData: string) => lz.decompressFromEncodedURIComponent(uriData)\n\n/**\n * convert DOT text to a png-encoded data URI\n */\nexport const toPngDataUri = (dot: string, createElement: elementCreator) => {\n    const svg = toSvg(dot)\n    const img = createElement('img') as HTMLImageElement\n    return new Promise<string>((resolve) => {\n        img.onload = () => resolve(toDataUrl(img, createElement))\n        img.setAttribute('src', 'data:image/svg+xml,' + encodeURIComponent(svg))\n    })\n}\n\nfunction toDataUrl(img: HTMLImageElement, createElement: elementCreator) {\n    const canvas = createElement('canvas') as HTMLCanvasElement\n    canvas.width = img.width\n    canvas.height = img.height\n    const context = canvas.getContext('2d')\n    if (context) {\n        context.drawImage(img, 0, 0)\n        const dataUrl = canvas.toDataURL('image/png')\n        return dataUrl\n    }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./node_modules/source-map-loader!./node_modules/tslint-loader!./src/core/codegen.ts","import template from './about.html'\n\nexport const name = \"c4LabAboutModal\"\nexport const options = {\n    template: template,\n    bindings: {\n        close: '&'\n    }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/header/about.component.js","import * as angular from 'angular'\nimport 'angular-ui-bootstrap'\nimport 'angular-ui-router'\n\nimport * as viewer from './viewer.component'\n\nexport default angular.module('c4-lab.viewer', ['ui.bootstrap',\n  'ui.router'])\n    .component(viewer.name, viewer.options)\n    .name;\n\n\n// WEBPACK FOOTER //\n// ./src/viewer/index.js","import * as angular from 'angular'\nimport 'babel-polyfill'\nimport 'angular-ui-codemirror'\nimport 'angular-ui-bootstrap'\nimport 'angular-ui-router'\nimport 'angular-animate'\nimport 'ng-file-upload'\nimport 'angulartics'\nimport angularticsGa from 'angulartics-google-analytics'\n\nimport * as editor from './editor'\nimport header from './header'\nimport * as shell from './shell'\nimport * as buildInfo from './build-info'\nimport configureRoutes from './routes'\nimport preview from './preview'\nimport viewer from './viewer'\nimport help from './help'\nimport store from './store/store.module'\nimport { angularInitialized } from './store/actions'\n\nangular.module('c4-lab', [\n  'ui.codemirror',\n  'ui.bootstrap',\n  'ui.router',\n  'ngAnimate',\n  'ngFileUpload',\n  angularticsGa,\n  header,\n  preview,\n  viewer,\n  help, store])\n  .component(buildInfo.name, buildInfo.options)\n  .component(editor.name, editor.options)\n  .component(shell.name, shell.options)\n  .run(editor.install)\n  .config(allowBlobsAndDataHrefs)\n  .config(configureRoutes)\n  .run(($state, $ngRedux, $window) => {\n    $ngRedux.dispatch(angularInitialized({ $state, $window }))\n  })\n\n// @ngInject\nfunction allowBlobsAndDataHrefs($compileProvider) {\n  $compileProvider\n    .aHrefSanitizationWhitelist(/^(https?|ftp|mailto|blob|data):/i);\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/index.js","export * from \"./editor.component\"\n\n\n// WEBPACK FOOTER //\n// ./src/editor/index.js","import 'codemirror/mode/commonlisp/commonlisp'\nimport 'codemirror/addon/edit/matchbrackets'\nimport 'codemirror/addon/edit/closebrackets'\nimport '../../node_modules/codemirror/lib/codemirror.css'\nimport '../../node_modules/codemirror/theme/elegant.css'\nimport CodeMirror from 'codemirror'\nimport template from './editor.html'\nimport './editor.css'\nimport { sourceChanged } from '../store/actions'\n\nexport class EditorController {\n\n    constructor($log, $ngRedux) {\n        'ngInject'\n        this.log = $log\n        this.editorOptions = {\n            lineNumbers: true,\n            mode: \"commonlisp\",\n            theme: \"elegant\",\n            matchBrackets: true,\n            autoCloseBrackets: true\n        }\n\n        this.unsubscribe = $ngRedux\n            .connect(this.mapStateToThis, { sourceChanged })(this);\n    }\n\n    $onDestroy() {\n        this.unsubscribe();\n    }\n\n    mapStateToThis(state) {\n        return {\n            text: state.source,\n            parseError: state.parseError,\n            syntaxIsValid: state.parseError ? false : true\n        }\n    }\n\n    parse(text) {\n        this.sourceChanged({ source: text })\n    }\n}\n\nexport const name = \"c4LabEditor\"\nexport const options = {\n    template: template,\n    controller: EditorController\n}\n\n// @ngInject\nexport function install($window, $log) {\n    $log.debug('installing codemirror')\n    $window.CodeMirror = CodeMirror;\n}\n\n\n// WEBPACK FOOTER //\n// ./src/editor/editor.component.js","module.exports = \"<div ng-class=\\\"{'bg-success': $ctrl.syntaxIsValid, 'bg-danger': !$ctrl.syntaxIsValid}\\\" style=\\\"padding: 0 1em;\\\">\\n    <ui-codemirror ui-codemirror-opts=\\\"$ctrl.editorOptions\\\" ng-model=\\\"$ctrl.text\\\" ng-model-options=\\\"{ debounce: 250 }\\\"\\n        ng-change=\\\"$ctrl.parse($ctrl.text)\\\">\\n    </ui-codemirror>\\n    <span class=\\\"help-block\\\">{{ $ctrl.parseError }}</span>\\n</div>\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/editor/editor.html\n// module id = 516\n// module chunks = 1","import template from './nav.html'\nimport './nav.css'\n// TODO: don't need core, just look at redux\nimport { uriEncode, formats } from '../core/index'\nimport { readAllText } from './importer'\nimport * as aboutComponent from './about.component'\nimport { sourceChanged } from '../store/actions'\n\nclass NavController {\n    constructor($state, $uibModal, $ngRedux) {\n        'ngInject'\n        this.$state = $state\n        this.$uibModal = $uibModal\n        this.exportFormats = formats\n\n        this.unsubscribe = $ngRedux.connect(this.mapStateToThis, { sourceChanged })(this);\n    }\n\n    $onDestroy() {\n        this.unsubscribe();\n    }\n\n    mapStateToThis(state) {\n        return { text: state.source, zoom: state.zoomNodeId }\n    }\n\n    href(zoom) {\n        return this.$state.href('load',\n            {\n                data: uriEncode(this.text),\n                zoom\n            });\n    }\n\n    export(format) {\n        this.onExport({ format, href: this.href() })\n    }\n\n    import(files) {\n        if (files) {\n            readAllText(files[0])\n                .then(text => this._onImport(text))\n        }\n    }\n\n    openAbout() {\n        this.$uibModal.open({\n            component: aboutComponent.name\n        })\n    }\n\n    _onImport(text) {\n        this.sourceChanged({ source: text })\n    }\n}\n\nexport const name = \"c4LabNav\"\nexport const options = {\n    template: template,\n    controller: NavController,\n    bindings: {\n        onExport: '&'\n    }\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/header/nav.component.js","module.exports = \"<nav class=\\\"navbar navbar-default\\\">\\n    <div class=\\\"container-fluid\\\">\\n        <div class=\\\"navbar-header\\\">\\n            <a class=\\\"navbar-brand\\\" href=\\\"#\\\">C4 Lab</a>\\n        </div>\\n\\n        <p class=\\\"navbar-text navbar-right c4lab-build\\\">\\n            <c4-lab-build-info></c4-lab-build-info>\\n        </p>\\n\\n        <div class=\\\"navbar-collapse collapse\\\">\\n            <ul class=\\\"nav navbar-nav\\\">\\n                <li>\\n                    <a popover-placement=\\\"bottom\\\" uib-popover-template=\\\"'_share.html'\\\" analytics-on=\\\"click\\\"\\n                        analytics-event=\\\"share\\\">\\n                        <span class=\\\"glyphicon glyphicon-duplicate\\\"> </span> Share\\n                    </a>\\n                </li>\\n                <li>\\n                    <a ngf-select=\\\"$ctrl.import($files)\\\" ngf-pattern=\\\"'.sexp'\\\" ngf-accept=\\\"'.sexp'\\\" analytics-on=\\\"click\\\"\\n                        analytics-event=\\\"import\\\">\\n                        <span class=\\\"glyphicon glyphicon-open-file\\\"> </span> Import\\n                    </a>\\n                </li>\\n                <li class=\\\"dropdown\\\" uib-dropdown>\\n                    <a uib-dropdown-toggle>\\n                        <span class=\\\"glyphicon glyphicon-picture\\\"> </span> Export <span class=\\\"caret\\\"></span>\\n                    </a>\\n                    <ul id=\\\"export-format-list\\\" class=\\\"dropdown-menu\\\" uib-dropdown-menu>\\n                        <li ng-repeat=\\\"format in $ctrl.exportFormats\\\">\\n                            <a ng-click=\\\"$ctrl.export(format)\\\" analytics-on=\\\"click\\\" analytics-event=\\\"export\\\"\\n                                analytics-label=\\\"{{format}}\\\">{{format}}</a>\\n                        </li>\\n                        <!-- TODO: fix gist integration with oauth login\\n                            <li>\\n                                <a ng-click=\\\"$ctrl.export('gist')\\\" analytics-on=\\\"click\\\" analytics-event=\\\"export\\\" analytics-label=\\\"gist\\\">GitHub Gist&nbsp;<img src=\\\"\" + require(\"./GitHub-Mark-32px.png\") + \"\\\"></a>\\n                            </li>\\n                        -->\\n                    </ul>\\n                </li>\\n                <li>\\n                    <!-- TODO: make this a modal route-->\\n                    <a href=\\\"#\\\" ng-click=\\\"$ctrl.openAbout()\\\" analytics-on=\\\"click\\\" analytics-event=\\\"about\\\">\\n                        <span class=\\\"glyphicon glyphicon-info-sign\\\"> </span> About\\n                    </a>\\n                </li>\\n                <li>\\n                    <a ui-sref=\\\"help\\\">\\n                        <span class=\\\"glyphicon glyphicon-question-sign\\\"> </span> Help\\n                    </a>\\n                </li>\\n            </ul>\\n        </div>\\n    </div>\\n</nav>\\n\\n<script type=\\\"text/ng-template\\\" id=\\\"_share.html\\\">\\n    <div style=\\\"width:10em;\\\">\\n        <a ng-href=\\\"{{$ctrl.href($ctrl.zoom)}}\\\" target=\\\"_blank\\\">\\n            <span class=\\\"glyphicon glyphicon-new-window\\\" > </span>\\n            Link to this page</a>\\n    </div>\\n</script>\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/header/nav.html\n// module id = 519\n// module chunks = 1","module.exports = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyRpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMy1jMDExIDY2LjE0NTY2MSwgMjAxMi8wMi8wNi0xNDo1NjoyNyAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNiAoTWFjaW50b3NoKSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDpFNTE3OEEyQTk5QTAxMUUyOUExNUJDMTA0NkE4OTA0RCIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDpFNTE3OEEyQjk5QTAxMUUyOUExNUJDMTA0NkE4OTA0RCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkU1MTc4QTI4OTlBMDExRTI5QTE1QkMxMDQ2QTg5MDREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOkU1MTc4QTI5OTlBMDExRTI5QTE1QkMxMDQ2QTg5MDREIi8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+m4QGuQAAAyRJREFUeNrEl21ojWEYx895TDPbMNlBK46IUiNmPvHBSUjaqc0H8pF5+aDUKPEBqU2NhRQpX5Rv5jWlDIWlMCv7MMSWsWwmb3tpXub4XXWdPHvc9/Gc41nu+nedc7/8r/99PffLdYdDPsvkwsgkTBwsA/PADJCnzX2gHTwBt8Hl7p537/3whn04XoDZDcpBlk+9P8AFcAghzRkJwPF4zGGw0Y9QS0mAM2AnQj77FqCzrtcwB1Hk81SYojHK4DyGuQ6mhIIrBWB9Xm7ug/6B/nZrBHBegrkFxoVGpnwBMSLR9EcEcC4qb8pP14BWcBcUgewMnF3T34VqhWMFkThLJAalwnENOAKiHpJq1FZgI2AT6HZtuxZwR9GidSHtI30jOrbawxlVX78/AbNfhHlomEUJJI89O2MqeE79T8/nk8nMBm/dK576hZgmA3cp/R4l9/UeSxiHLVIlNm4nFfT0bxyuIj7LHRTKai+zdJobwMKzcZSJb0ePV5PKN+BqAAKE47UlMnERELMM3EdYP/yrd+XYb2mOiYBiQ8OQnoRBlXrl9JZix7D1pHTazu4MoyBcnYamqAjIMTR8G4FT8LuhLsexXYYjICBiqhQBvYb6fLZIJCjPypVvaOoVAW2WcasCnL2Nq82xHJNSqlCeFcDshaPK0twkAhosjZL31QYw+1rlMpWGMArl23SBsZZO58F2tlJXmjOXS+s4WGvpMiBJT/I2PInZ6lIs9/hBsNS1hS6BG0DSqmYEDRlCXQrmy50P1oDRKTSegmNbUsA0zDMwRhPJXeCE3vWLPQMvan6X8AgIa1vcR4AkGZkDR4ejJ1UHpsaVI0g2LInpOsNFUud1rhxSV+fzC9Woz2EZkWQuja7/B+jUrgtIMpy9YCW4n4K41YfzRneW5E1KJTe4B2Zq1Q5EHEtj4U3AfEzR5SVY4l7QYQPJdN2as7RKBF0BPZqqH4VgMAMBL8Byxr7y8zCZiDlnOcEKIPmUpgB5Z2ww5RdOiiRiNajUmWda5IG6WbhsyY2fx6m8gLcoJDJFkH219M3We1+cnda93pfycZpIJEL/s/wSYADmOAwAQgdpBAAAAABJRU5ErkJggg==\"\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/header/GitHub-Mark-32px.png\n// module id = 520\n// module chunks = 1","import { Parser } from './Parser'\nexport { SyntaxError } from 'sexpr-plus'\nexport { default as ParseError } from './ParseError'\nexport { default as InvalidDirectionError } from './InvalidDirectionError'\nexport { default as OptsNotFoundError } from './OptsNotFoundError'\nexport { default as NameNotFoundError } from './NameNotFoundError'\n\nexport const parse = (text: string) => new Parser().parse(text)\n\n\n\n// WEBPACK FOOTER //\n// ./node_modules/source-map-loader!./node_modules/tslint-loader!./src/core/parse/index.ts","import * as path from 'path'\nimport * as sexp from 'sexpr-plus'\nimport { Md5 } from 'ts-md5/dist/md5'\n\nimport { IEdge, IGraph, INode, isEdge, NodeId } from '../interfaces'\n\nimport InvalidDirectionError from './InvalidDirectionError'\nimport NameNotFoundError from './NameNotFoundError'\nimport OptsNotFoundError from './OptsNotFoundError'\nimport ParseError from './ParseError'\nimport TitleNotAStringError from './TitleNotAStringError'\nimport TitleNotAtTopLevelError from './TitleNotAtTopLevelError'\n\nexport const pathToId = (p: string) => Md5.hashStr(p, false) as string\n\nfunction isString(x: sexp.Item): x is sexp.String {\n    return x && x.type === 'string'\n}\n\nfunction isList(x: sexp.Item): x is sexp.List {\n    return x && x.type === 'list'\n}\n\nfunction isAtom(x: sexp.Item): x is sexp.Atom {\n    return x && x.type === 'atom'\n}\n\nconst stripComments = (text: string) => text.replace(/^\\s*;;.*$/gm, '')\n\nconst keywordAliases = [\n    { from: /^:desc.*/i, to: 'description' },\n    { from: /^:to/i, to: 'to' },\n    { from: /^:tech/i, to: 'tech' },\n    { from: /^:dir.*/i, to: 'direction' },\n]\n\nfunction canonicalize(key: string) {\n    return keywordAliases\n        .filter(({ from }) => from.test(key))\n        .map(({ to }) => to)[0] || key\n}\n\nfunction parseKeywordArgs(kwargs: sexp.Item[], allowed = /.*/): any {\n    if (kwargs.length === 0) { return {} }\n\n    const [keyword, value, ...rest] = kwargs\n    if (!isAtom(keyword)) { throw new Error('Expected keyword to be an atom') }\n    if (!isString(value)) { throw new Error('Expected value to be a string') }\n\n    const key = canonicalize(keyword.content)\n\n    return Object.assign(\n        allowed.test(key) ? { [key]: value.content } : {},\n        parseKeywordArgs(rest, allowed))\n}\n\nexport class Parser {\n\n    private idMap: { [id: string]: INode }\n    private pathMap: { [id: string]: NodeId }\n    private edges: IEdge[]\n    private items: INode[]\n    private graphTitle: string\n\n    constructor() {\n        this.idMap = {}\n        this.pathMap = {}\n        this.edges = []\n        this.items = []\n    }\n\n    public parse(text: string): IGraph {\n        const tokens = sexp.parse(text)\n        this.buildIR(tokens)\n        for (const e of this.edges) {\n            this.postProcessEdge(e)\n        }\n\n        return {\n            edges: this.edges,\n            idMap: this.idMap,\n            items: this.items,\n            pathMap: this.pathMap,\n            roots: this.items\n                .filter((x) => !x.parentId)\n                .map((x) => x.id),\n            title: this.graphTitle,\n        }\n    }\n\n    private buildIR(tokens: sexp.Item[], parent?: INode) {\n        return tokens.map((x) => this.buildIRNode(x, parent))\n    }\n\n    private buildIRNode(token: sexp.Item, parent?: INode): INode | IEdge | null {\n        if (!isList(token)) {\n            throw new Error('bare string not permitted')\n        }\n        const [head, ...tail] = token.content\n        if (!isAtom(head)) {\n            throw new Error(`expected atom, found ${head.type}`)\n        }\n        const node = this._buildIRNode(head.content, tail, parent)\n        if (!node) { return null }\n\n        if (!isEdge(node) && !node.children.every(isEdge)) {\n            node.canExpand = true\n        }\n        return node\n    }\n\n    private _buildIRNode(head: string, tail: sexp.Item[], parent?: INode): INode | IEdge | null {\n        const type = head.replace(/^def(ine)?-/i, '').toLowerCase().trim()\n        switch (type) {\n            case 'edge':\n                return this.edge(tail, parent)\n            case 'title':\n                this.title(tail, parent)\n                return null\n            default:\n                return this.item(type, tail, parent)\n        }\n    }\n\n    private item(type: string, tokens: sexp.Item[], parent?: INode): INode {\n        const [opts, ...children] = tokens\n        if (!isList(opts)) {\n            throw new OptsNotFoundError(type)\n        }\n        const [name, ...kwargs] = opts.content\n        if (!isString(name) || name.content === '') {\n            throw new NameNotFoundError(type)\n        }\n\n        const p = this.pathToNode(name.content, parent).toString()\n        const node: INode = {\n            children: [],\n            id: pathToId(p),\n            name: name.content,\n            path: p,\n            type,\n        }\n        if (parent) {\n            node.parentId = parent.id\n        }\n\n        this.idMap[node.id] = node\n        this.pathMap[node.path] = node.id\n        Object.assign(node,\n            parseKeywordArgs(kwargs, /description|tech/))\n        this.items.push(node)\n        for (const n of this.buildIR(children, node)) {\n            if (n) {\n                node.children.push(n)\n            }\n        }\n        return node\n    }\n\n    private edge(kwargs: sexp.Item[], parent?: INode): IEdge {\n        if (!parent) { throw new Error('edge at top level?') }\n        const edge = Object.assign(\n            { sourceId: parent.id, type: 'edge' },\n            parseKeywordArgs(kwargs, /description|to|tech|direction/))\n        this.edges.push(edge)\n        return edge\n    }\n\n    private title([input]: sexp.Item[], parent?: INode): void {\n        if (!isString(input)) {\n            throw new TitleNotAStringError(input.toString())\n        }\n        if (parent) { throw new TitleNotAtTopLevelError() }\n        this.graphTitle = input.content\n    }\n\n    private pathToNode(name: string, parent?: INode): string {\n        return parent\n            ? this.idMap[parent.id].path + '/' + name\n            : name\n    }\n\n    private postProcessEdge(edge: IEdge) {\n        if (edge.to.startsWith('.')) {\n            const src = this.idMap[edge.sourceId]\n            if (!src.parentId) {\n                throw new Error('relative paths have to have a parent')\n            }\n            const parent = this.idMap[src.parentId]\n            edge.to = path.join(parent.path, edge.to)\n        }\n\n        edge.destinationId = this.pathMap[edge.to]\n\n        if (!edge.destinationId) {\n            throw new ParseError(`Could not find node '${edge.to}'`)\n        }\n        if (edge.sourceId === edge.destinationId) {\n            throw new ParseError(`Edge cannot be both from and to '${edge.to}'`)\n        }\n        if (edge.direction) {\n            if (/^(push|pull|both)$/i.test(edge.direction)) {\n                edge.direction = edge.direction.toLowerCase()\n            } else {\n                throw new InvalidDirectionError(edge.direction)\n            }\n        }\n\n        edge.id = pathToId(edge.sourceId + edge.destinationId)\n        edge.sourceParentIds = this.findParentIds(edge.sourceId)\n        edge.destinationParentIds = this.findParentIds(edge.destinationId)\n    }\n\n    private findParentIds(id: string): string[] {\n        const node = this.idMap[id]\n        if (!node.parentId) { return [] }\n\n        return [node.parentId]\n            .concat(this.findParentIds(node.parentId))\n    }\n}\n\n/*\nTODO: detect errors:\n\n* duplicate paths\n\n*/\n\n\n\n// WEBPACK FOOTER //\n// ./node_modules/source-map-loader!./node_modules/tslint-loader!./src/core/parse/Parser.ts","\nexport interface IGraph {\n    items: INode[]\n    edges: IEdge[]\n    title?: string\n    roots: NodeId[]\n    idMap: { [id: string]: INode }\n    pathMap: { [path: string]: NodeId }\n}\n\nexport interface IEdge {\n    type: 'edge'\n    id: NodeId\n    sourceId: NodeId\n    to: Path\n    destinationId: NodeId\n    sourceParentIds: NodeId[]\n    destinationParentIds: NodeId[]\n    description?: string\n    tech?: string\n    direction?: string\n}\n\nexport function isEdge(x: INode | IEdge): x is IEdge {\n    return x.type === 'edge'\n}\n\nexport interface INode {\n    type: string\n    name: string\n    id: NodeId\n    path: Path\n    children: Array<INode | IEdge>\n    parentId?: NodeId\n    description?: string\n    tech?: string\n    canExpand?: boolean\n}\n\nexport type NodeId = string\nexport type Path = string\n\n\n\n// WEBPACK FOOTER //\n// ./node_modules/source-map-loader!./node_modules/tslint-loader!./src/core/interfaces.ts","import ParseError from './ParseError'\n\nexport default class TitleNotAStringError extends ParseError {\n    constructor(input: string) {\n        super('title must be a string, was: ' + JSON.stringify(input))\n    }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./node_modules/source-map-loader!./node_modules/tslint-loader!./src/core/parse/TitleNotAStringError.ts","import ParseError from './ParseError'\n\nexport default class TitleNotAtTopLevelError extends ParseError {\n    constructor() {\n        super('title is only allowed at the top level')\n    }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./node_modules/source-map-loader!./node_modules/tslint-loader!./src/core/parse/TitleNotAtTopLevelError.ts","const LOCALSTORAGE_KEY = 'C4-LAB-ACTIVE-DOC-VNEXT'\n\nexport class DataStore {\n\n    constructor(private localStorage: Storage) { }\n\n    public load() {\n        return this.localStorage.getItem(LOCALSTORAGE_KEY)\n    }\n\n    public save(text: string) {\n        this.localStorage.setItem(LOCALSTORAGE_KEY, text)\n    }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./node_modules/source-map-loader!./node_modules/tslint-loader!./src/core/DataStore.ts","import { toPngDataUri } from '../codegen'\n\nexport const formats = 'sexp dot png'.split(' ')\n\nexport class Exporter {\n    private createElement: (e: string) => HTMLElement\n\n    constructor(document: HTMLDocument) {\n        this.createElement = (e) => document.createElement(e)\n    }\n\n    public export(format: string, title: string | null, text: string, dot: string) {\n        const safeTitle = title || 'c4-lab-graph'\n        switch (format) {\n            case 'sexp':\n                return this.sexp(safeTitle, text)\n            case 'dot':\n                return this.dot(safeTitle, dot)\n            case 'png':\n                return this.png(safeTitle, dot)\n            default:\n                throw new Error(`unknown format: ${format}`)\n        }\n    }\n\n    public sexp(title: string, text: string) {\n        this.downloadFile(`${title}.sexp`, text, 'text/plain')\n    }\n\n    private dot(title: string, dot: string) {\n        this.downloadFile(`${title}.dot`, dot, 'text/plain')\n    }\n\n    private png(title: string, dot: string) {\n        toPngDataUri(dot, this.createElement)\n            .then((dataUri) => this.downloadFile(`${title}.png`, dataUri))\n    }\n\n    private downloadFile(filename: string, content: string, contentType?: string) {\n        const a = this.createElement('a') as HTMLAnchorElement\n        a.download = filename\n        if (contentType) {\n            a.href = `data:${contentType},${encodeURIComponent(content)}`\n        } else {\n            a.href = content\n        }\n        a.click()\n    }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./node_modules/source-map-loader!./node_modules/tslint-loader!./src/core/exporter/index.ts","import { flattenDeep, isString, uniq } from 'lodash'\nimport * as wordwrap from 'wordwrap'\nimport { DOT } from './DOT'\nimport { IEdge, IGraph, INode, NodeId } from './interfaces'\n\nconst DEFAULT_SHAPE = 'box'\nconst typeShapeMap: any = {\n    actor: 'egg',\n    component: 'component',\n    container: 'box3d',\n}\n\nconst VERBOSE = false\nconst INDENT = '  '\n\nexport class DotContext {\n    private wordwrap: (text: string) => string\n    private hrefTo?: (text: string) => string\n    private graph: IGraph\n    private zoomNodeId: NodeId\n    private visibleIds: NodeId[]\n    private visibleEdges: IEdge[]\n    private rootNode: INode\n\n    constructor(hrefTo?: ((text: string) => string)) {\n        // TODO: why doesn't `wordwrap(30)` work? Something about typescript definitions\n        this.wordwrap = wordwrap.soft(0, 30)\n        this.hrefTo = hrefTo\n    }\n\n    public load(graph: IGraph, zoomNodeId: NodeId) {\n        this.graph = graph\n        this.zoomNodeId = zoomNodeId\n        this.visibleIds = zoomNodeId\n            ? this.findVisibleNodes(zoomNodeId)\n            : graph.roots\n\n        this.visibleIds.sort()\n\n        this.visibleEdges = graph.edges\n            .filter((x) => this.isEdgeVisible(x))\n    }\n\n    public draw() {\n        return [...this._draw()].join('\\n')\n    }\n\n    private * _draw() {\n        yield `digraph g {`\n        yield* this.digraphHeaders(INDENT)\n        if (this.rootNode) {\n            if (this.rootNode.parentId) {\n                yield* this.drawChildCluster(INDENT, this.rootNode.parentId)\n            } else {\n                yield* this.drawCluster(INDENT, this.rootNode)\n            }\n        } else {\n            yield* this.drawItems(this.visibleIds, INDENT)\n        }\n        yield ''\n        yield* this.visibleEdges.map((x) => this.drawEdge(x, INDENT))\n        yield '}'\n        yield ''\n    }\n\n    private findVisibleNodes(zoomNodeId: NodeId) {\n        this.rootNode = this.graph.idMap[zoomNodeId]\n        let visibleNodes = this.rootNode.children\n            .concat([this.rootNode])\n\n        if (this.rootNode.parentId) {\n            const parent = this.graph.idMap[this.rootNode.parentId]\n            visibleNodes = visibleNodes.concat(parent.children)\n            visibleNodes.push(parent)\n        }\n\n        const visibleIds = visibleNodes\n            .map((x) => x.id)\n            .concat(this.graph.roots)\n            .filter((x) => x)\n\n        return uniq(visibleIds)\n    }\n\n    private toDotId(nodeOrId: string | INode | IEdge) {\n        const id = isString(nodeOrId) ? nodeOrId : nodeOrId.id\n\n        return 'g' + this.visibleIds.indexOf(id)\n    }\n\n    private toDescription(nodeOrText: string | INode | IEdge, htmlNewlines = true) {\n        const text = isString(nodeOrText) ? nodeOrText : nodeOrText.description\n\n        if (!text) { return '' }\n\n        const wrapped = this.wordwrap(text)\n\n        return htmlNewlines\n            ? wrapped.replace(/\\n/g, '<br/>\\n')\n            : wrapped\n    }\n\n    private toLabel(edgeOrText: string | IEdge) {\n        return this.toDescription(edgeOrText, false)\n            .replace(/\"/g, '\\\\\"')\n            .replace(/\\n/g, '\\\\n')\n    }\n\n    private isEdgeVisible(edge: IEdge) {\n        return this.isIdVisible(edge.sourceId)\n            || this.isIdVisible(edge.destinationId)\n            || this.isCrossingSystems(edge)\n    }\n\n    private isCrossingSystems(edge: IEdge) {\n        const visibleSourceIds = this.findVisibleIds(edge.sourceParentIds)\n        const visibleDestinationIds = this.findVisibleIds(edge.destinationParentIds)\n\n        return visibleSourceIds[0] !== visibleDestinationIds[0]\n    }\n\n    private findVisibleIds(ids: string[]) {\n        return ids.filter((x) => this.isIdVisible(x))\n    }\n\n    private isIdVisible(id: string) {\n        return this.visibleIds.includes(id)\n    }\n\n    private * drawCluster(indent: string, rootNode: INode, style = 'rounded') {\n        const dotId = this.toDotId(rootNode)\n        const label = this.toLabel(rootNode.name)\n\n        if (VERBOSE) { yield `${indent}# <drawCluster>` }\n        yield `${indent}subgraph cluster_${dotId} {\n${indent}  label=<${DOT.b(label)}> style=\"${style}\"`\n        yield ''\n        yield `${indent}  ${dotId} [style=\"invisible\"]`\n        yield ''\n        yield* this.drawItems(rootNode.children, indent + INDENT)\n        yield `${indent}}`\n        if (!rootNode.parentId) {\n            const nonClustered = this.graph.roots\n                .filter((x) => x !== rootNode.id)\n                .filter((x) => x !== rootNode.parentId)\n\n            yield* this.drawItems(nonClustered, indent)\n        }\n        if (VERBOSE) { yield `${indent}# </drawCluster>` }\n    }\n\n    private * drawChildCluster(indent: string, parentId: NodeId) {\n        const parent = this.graph.idMap[parentId]\n        const dotId = this.toDotId(parent)\n        const label = this.toLabel(parent.name)\n\n        const nonClustered = this.graph.roots\n            .filter((x) => x !== parent.id)\n        const otherChildren = parent.children\n            .filter((x) => x !== this.rootNode)\n\n        const nextIndent = `${indent}${INDENT}`\n\n        if (VERBOSE) { yield `${indent}# <drawChildCluster>` }\n        yield `${indent}subgraph cluster_${dotId} {`\n        yield `${nextIndent}label=<${DOT.b(label)}> style=\"rounded\"`\n        yield ''\n        yield `${nextIndent}${dotId} [style=\"invisible\"]`\n        yield* this.drawItems(otherChildren, nextIndent)\n        yield ''\n        yield* this.drawCluster(nextIndent, this.rootNode, 'solid')\n        yield `${indent}}`\n        yield* this.drawItems(nonClustered, indent)\n        if (VERBOSE) { yield `${indent}# </drawChildCluster>` }\n    }\n\n    private * digraphHeaders(indent: string) {\n        yield `${indent}compound=true`\n        if (this.graph.title) {\n            yield `${indent}label=\"${this.toLabel(this.graph.title)}\"`\n            yield `${indent}fontsize=20`\n            yield `${indent}labelloc=t`\n        }\n        yield `${indent}node[fontsize=12]`\n        yield `${indent}edge[fontsize=12]`\n        yield ''\n    }\n\n    private toTechDescription(text?: string) {\n        if (!text) { return '' }\n\n        text = this.toDescription(text)\n        text = DOT.font('#666666', DOT.i(`&#171;${text}&#187;`))\n\n        return `\n<br/>\n${text}\n<br/>`\n    }\n\n    private * drawItems(nodesOrIds: Array<string | INode | IEdge>, indent: string) {\n        if (VERBOSE) { yield `${indent}# <drawItems>` }\n        yield* nodesOrIds\n            .map((x) => isString(x) ? this.graph.idMap[x] : x)\n            .filter((x) => x.type !== 'edge')\n            .map((x) => this.drawItem((x as INode), indent))\n        if (VERBOSE) { yield `${indent}# </drawItems>` }\n    }\n\n    private drawItem(node: INode, indent: string) {\n        const dotId = this.toDotId(node)\n\n        const tech = this.toTechDescription(node.tech)\n\n        const desc = node.description\n            ? '\\n<br/>\\n' + this.toDescription(node)\n            : ''\n\n        const shape = typeShapeMap[node.type] || DEFAULT_SHAPE\n\n        const attrs: any = {\n            shape,\n        }\n\n        let name = DOT.b(node.name)\n        if (this.hrefTo && node.children && node.children.some((x) => x.type !== 'edge')) {\n            attrs.href = this.hrefTo(node.id)\n            attrs.tooltip = `See more details about ${node.name}`\n            name = DOT.font('blue', DOT.u(name))\n        }\n\n        attrs.label = `<\n${name}${tech}${desc}\n${indent}>`\n\n        return `${indent}${dotId} ${DOT.attrList(attrs)}`\n    }\n\n    private drawEdge(edge: IEdge, indent: string) {\n\n        const srcOk = this.isIdVisible(edge.sourceId)\n        const dstOk = this.isIdVisible(edge.destinationId)\n\n        const getId = (idOk: boolean, id: NodeId, parentIds: NodeId[]) => {\n            const result = idOk\n                ? id\n                : parentIds.find((x) => this.isIdVisible(x))\n\n            if (result) { return result }\n            throw new Error('Unknown id')\n        }\n\n        const srcId = getId(srcOk, edge.sourceId, edge.sourceParentIds)\n        const dstId = getId(dstOk, edge.destinationId, edge.destinationParentIds)\n\n        const src = this.toDotId(srcId)\n        const dst = this.toDotId(dstId)\n\n        const attrs: any = {}\n\n        if (edge.description) {\n            attrs.label = this.toLabel(edge)\n        }\n\n        if (!(srcOk && dstOk)) {\n            attrs.style = 'dashed'\n        }\n\n        if (srcId === this.zoomNodeId) {\n            attrs.ltail = `cluster_${src}`\n        }\n\n        if (dstId === this.zoomNodeId) {\n            attrs.lhead = `cluster_${dst}`\n        }\n        attrs.dir = this.getEdgeDirection(edge.direction)\n\n        return `${indent}${src} -> ${dst} ${DOT.attrList(attrs)}`\n    }\n\n    private getEdgeDirection(direction: string | undefined): string | null {\n        switch (direction) {\n            case 'both':\n                return 'both'\n            case 'pull':\n                return 'back'\n            default:\n                return null\n        }\n    }\n}\n\n/**\n * build a DOT representation of the graph\n */\nexport const toDot = (graph: IGraph, zoomNodeId: NodeId, hrefTo: (id: string) => string) => {\n    const ctx = new DotContext(hrefTo)\n    ctx.load(graph, zoomNodeId)\n    return ctx.draw()\n}\n\n\n\n// WEBPACK FOOTER //\n// ./node_modules/source-map-loader!./node_modules/tslint-loader!./src/core/dot-writer.ts","export class DOT {\n    public static i(text: string) { return `<i>${text}</i>` }\n    public static b(text: string) { return `<b>${text}</b>` }\n    public static u(text: string) { return `<u>${text}</u>` }\n    public static font(color: string, text: string) { return `<font color=\"${color}\">${text}</font>` }\n    public static attrList(attrs: any) {\n        const dotAttrs = Reflect.ownKeys(attrs)\n            .filter((x) => attrs[x])\n            .map((x) => `${x}=${DOT.quoteAttr(attrs[x])}`)\n            .join(' ')\n\n        return `[${dotAttrs}]`\n    }\n    public static quoteAttr(value: string) {\n        return /^</.test(value) ? value : `\"${value}\"`\n    }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./node_modules/source-map-loader!./node_modules/tslint-loader!./src/core/DOT.ts","export const readAllText = file => {\n    const reader = new FileReader()\n    return new Promise((resolve, reject) => {\n        reader.onload = loadEvt => resolve(loadEvt.target.result);\n        reader.onerror = reject;\n        reader.readAsText(file);\n    });\n}\n\n\n// WEBPACK FOOTER //\n// ./src/header/importer.js","module.exports = \"<div class=\\\"modal-header\\\">\\n    <h3 class=\\\"modal-title\\\" id=\\\"modal-title\\\">About</h3>\\n</div>\\n<div class=\\\"modal-body\\\" id=\\\"modal-body\\\">\\n    <p>C4 Lab helps to create diagrams expressing a software architecture using a small lisp-like language, and share those\\n        diagrams as images or text.\\n    </p>\\n    <p>\\n        This is a based on <a href=\\\"http://www.simonbrown.je/\\\">Simon Brown</a>'s <a href=\\\"http://www.codingthearchitecture.com/2014/08/24/c4_model_poster.html\\\">C4</a>        approach: Context, Containers, Components, and Classes. See <a href=\\\"https://leanpub.com/visualising-software-architecture\\\">Visualising Software Architecture</a>        for more information.\\n    </p>\\n    <p>\\n        If you have any feedback or problems, please open a <a href=\\\"https://github.com/ryepup/c4-lab/issues\\\">issue on github</a>.\\n    </p>\\n    <c4-lab-build-info></c4-lab-build-info>\\n</div>\\n<div class=\\\"modal-footer\\\">\\n    <button class=\\\"btn btn-primary\\\" type=\\\"button\\\" ng-click=\\\"$ctrl.close()\\\">Close</button>\\n</div>\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/header/about.html\n// module id = 539\n// module chunks = 1","export * from \"./app.component\"\n\n\n// WEBPACK FOOTER //\n// ./src/shell/index.js","// TODO: don't need core, just look at redux\nimport { Exporter } from '../core/index'\nimport { GistExporter } from '../core/exporter/gist'\nimport template from './app.html'\n\nexport class AppController {\n\n    constructor($log, $window, $ngRedux) {\n        'ngInject'\n        this.log = $log\n        this.$window = $window\n        this.exporter = new Exporter($window.document)\n        this.codeExpanded = true;\n\n        this.unsubscribe = $ngRedux.connect(this.mapStateToThis)(this);\n    }\n\n    $onDestroy() {\n        this.unsubscribe();\n    }\n\n    mapStateToThis(state) {\n        return { text: state.source, graph: state.graph, dot: state.dot }\n    }\n\n    /**\n     * calculate the base uri\n     *\n     * `$location.path()` gives the wrong value\n     */\n    get baseUri() {\n        const l = this.$window.document.location;\n        return `${l.origin}${l.pathname}`\n    }\n\n    onExport(format, href) {\n        this.log.debug('Exporting as', format, href)\n        if (format === 'gist') {\n            const gist = new GistExporter()\n            // TODO: show a loading spinner or something while we wait\n            gist.export(this.graph.title, this.text, this.baseUri + href)\n                .then((result) => {\n                    // TODO: show a modal with the link\n                    this.$window.open(result.url, '_blank')\n                })\n        } else {\n            this.exporter.export(format, this.graph.title, this.text, this.dot)\n        }\n\n    }\n}\n\nexport const name = \"c4LabApp\"\nexport const options = {\n    template: template,\n    controller: AppController\n}\n\n\n// WEBPACK FOOTER //\n// ./src/shell/app.component.js","import Github from 'github-api'\n\ninterface IGistResult {\n    id: string\n    url: URL\n}\n\nfunction createReadme(title: string, url: URL) {\n    return `# C4 Diagrams for *${title}*\n\nThese files were exported from [C4-Lab](https://ryepup.github.io/c4-lab)\n\n[View or edit these diagrams](${url})\n`\n}\n\nexport class GistExporter {\n\n    constructor(private gh = new Github()) { }\n\n    public export(title: string, sexp: string, url: URL): Promise<IGistResult> {\n        const gist = this.gh.getGist()\n        // TODO: use async/await\n        return gist.create({\n            description: `C4 diagrams for '${title}'`,\n            files: {\n                'README.md': {\n                    content: createReadme(title, url),\n                },\n                [`${title}.sexp`]: {\n                    content: sexp,\n                },\n                // TODO: save the top-level SVG\n            },\n            public: true,\n        })\n            .then((resp) => {\n                return {\n                    id: resp.data.id,\n                    url: new URL(resp.data.html_url),\n                }\n            })\n    }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./node_modules/source-map-loader!./node_modules/tslint-loader!./src/core/exporter/gist.ts","module.exports = \"<c4-lab-nav on-export=\\\"$ctrl.onExport(format, href)\\\"></c4-lab-nav>\\n<div class=\\\"container-fluid\\\">\\n    <div class=\\\"row\\\">\\n        <div ng-class=\\\"$ctrl.codeExpanded ? 'col-md-6' : 'col-md-4'\\\">\\n            <c4-lab-editor></c4-lab-editor>\\n\\n            <button class=\\\"btn btn-default btn-block\\\" type=\\\"button\\\" ng-click=\\\"$ctrl.codeExpanded = !$ctrl.codeExpanded\\\">\\n                <span class=\\\"glyphicon\\\" ng-class=\\\"$ctrl.codeExpanded ? 'glyphicon-chevron-left' : 'glyphicon-chevron-right'\\\"></span>\\n                Show {{$ctrl.codeExpanded ? 'less' : 'more'}} code\\n            </button>\\n        </div>\\n        <div ng-class=\\\"$ctrl.codeExpanded ? 'col-md-6' : 'col-md-8'\\\">\\n            <c4-lab-viewer></c4-lab-viewer>\\n        </div>\\n    </div>\\n</div>\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/shell/app.html\n// module id = 578\n// module chunks = 1","import template from './template.html'\n\nclass BuildInfoController {\n    constructor() {\n        /* global process */\n        this.version = process.env.npm_package_version\n        this.build = process.env.TRAVIS_BUILD_NUMBER || 'SNAPSHOT'\n        this.hash = process.env.TRAVIS_COMMIT || process.env.npm_package_gitHead || 'HEAD'\n    }\n}\n\nexport const name = 'c4LabBuildInfo'\nexport const options = {\n    template: template,\n    controller: BuildInfoController\n}\n\n\n// WEBPACK FOOTER //\n// ./src/build-info/index.js","module.exports = \"<span class=\\\"text-muted small\\\" title=\\\"{{$ctrl.hash}}\\\">\\n  v{{$ctrl.version}}+{{$ctrl.build}}\\n</span>\\n\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/build-info/template.html\n// module id = 580\n// module chunks = 1","import { zoomChanged } from './store/actions'\n\nfunction configureRoutes($stateProvider, $urlRouterProvider) {\n  'ngInject'\n  $urlRouterProvider.otherwise('/');\n  $stateProvider\n    .state('home', {\n      url: '/?zoom',\n      component: 'c4LabApp',\n      resolve: {\n        zoom: $stateParams => $stateParams.zoom\n      },\n      onEnter: (zoom, $ngRedux) => {\n        const currentZoom = $ngRedux.getState().zoomNodeId;\n        if (currentZoom !== zoom) {\n          $ngRedux.dispatch(zoomChanged({ zoomNodeId: zoom }))\n        }\n      }\n    })\n    .state('load', {\n      url: '/load/{data}?zoom',\n      component: 'c4LabPreview',\n      resolve: {\n        encodedText: $stateParams => $stateParams.data,\n        zoom: $stateParams => $stateParams.zoom\n      },\n      onEnter: (zoom, $ngRedux) => {\n        // TODO: dedupe with other endpoint\n        const currentZoom = $ngRedux.getState().zoomNodeId;\n        if (currentZoom !== zoom) {\n          $ngRedux.dispatch(zoomChanged({ zoomNodeId: zoom }))\n        }\n      }\n\n    })\n    .state('help', {\n      url: '/help',\n      component: 'c4LabHelp'\n    })\n}\n\nexport default configureRoutes;\n\n\n// WEBPACK FOOTER //\n// ./src/routes.js","import * as angular from 'angular'\nimport * as previewComponent from './preview.component'\nimport header from '../header'\nimport viewer from '../viewer'\n\nexport default angular.module('c4-lab.preview', [header, viewer])\n    .component(previewComponent.name, previewComponent.options)\n    .name;\n\n\n// WEBPACK FOOTER //\n// ./src/preview/index.js","import template from './preview.html'\n// TODO: don't need core, just look at redux\nimport { parse, uriDecode, Exporter, DataStore } from '../core/index'\n\nclass PreviewComponent{\n    constructor($window, $state){\n        this.exporter = new Exporter($window.document)\n        this.storage = new DataStore($window.localStorage)\n        this.$state = $state\n    }\n\n    $onChanges(){\n        this.text = uriDecode(this.encodedText)\n        this.graph = parse(this.text)\n    }\n\n    onExport(format) {\n        this.exporter.export(format, this.graph.title, this.text, this.dot)\n    }\n\n    edit(){\n        this.storage.save(this.text)\n        this.$state.go('home')\n    }\n}\n\n\nexport const name = 'c4LabPreview';\nexport const options = {\n    template,\n    controller: PreviewComponent,\n    bindings: {\n        zoom: '<',\n        encodedText: '<'\n    }\n}\n\n\n// WEBPACK FOOTER //\n// ./src/preview/preview.component.js","module.exports = \"<c4-lab-nav text=\\\"$ctrl.text\\\" on-export=\\\"$ctrl.onExport(format)\\\" zoom=\\\"$ctrl.zoom\\\"></c4-lab-nav>\\n<c4-lab-viewer graph=\\\"$ctrl.graph\\\" zoom=\\\"$ctrl.zoom\\\" ng-model=\\\"$ctrl.dot\\\">\\n    <button type=\\\"button\\\" class=\\\"btn btn-primary hidden-xs hidden-sm\\\" ng-click=\\\"$ctrl.edit()\\\">Start editing this graph</button>\\n</c4-lab-viewer>\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/preview/preview.html\n// module id = 584\n// module chunks = 1","import template from './viewer.html'\nimport { zoomChanged } from '../store/actions'\n\n\nclass ViewerComponent {\n    constructor($log, $sce, $ngRedux) {\n        'ngInject'\n        this.$log = $log;\n        this.$sce = $sce;\n\n        this.unsubscribe = $ngRedux.connect(this.mapStateToThis.bind(this), { zoomChanged })(this);\n    }\n\n    $onDestroy() {\n        this.unsubscribe();\n    }\n\n    mapStateToThis(state) {\n        return {\n            expandableNodes: state.zoomableNodes,\n            graph: state.graph,\n            zoom: state.zoomNodeId,\n            dot: state.dot,\n            svg: this.$sce.trustAsHtml(state.svg)\n        }\n    }\n\n    onZoom() {\n        this.zoomChanged({ zoomNodeId: this.zoom });\n    }\n}\n\nexport const name = 'c4LabViewer';\nexport const options = {\n    transclude: true,\n    template,\n    controller: ViewerComponent\n}\n\n\n// WEBPACK FOOTER //\n// ./src/viewer/viewer.component.js","module.exports = \"<div>\\n    <form class=\\\"form-inline\\\">\\n        <div class=\\\"form-group\\\">\\n            <label for=\\\"zoomableNodes\\\">Zoom to node</label>\\n            <select name=\\\"zoomableNodes\\\" class=\\\"form-control\\\" ng-model=\\\"$ctrl.zoom\\\" ng-change=\\\"$ctrl.onZoom()\\\">\\n                <option ng-value=\\\"undefined\\\">--none--</option>\\n                <option ng-repeat=\\\"node in $ctrl.expandableNodes track by node.id\\\"\\n                    value=\\\"{{node.id}}\\\">{{node.path}}</option>\\n            </select>\\n        </div>\\n        <div class=\\\"form-group\\\" ng-transclude>\\n        </div>\\n    </form>\\n    <uib-tabset>\\n        <uib-tab heading=\\\"svg\\\">\\n            <div ng-bind-html=\\\"$ctrl.svg\\\"></div>\\n        </uib-tab>\\n        <uib-tab heading=\\\"dot\\\">\\n            <p>This is for debugging purposes</p>\\n            <!-- TODO: a disabled text area -->\\n            <pre>{{$ctrl.dot}}</pre>\\n        </uib-tab>\\n    </uib-tabset>\\n    <div>\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/viewer/viewer.html\n// module id = 586\n// module chunks = 1","import * as angular from 'angular'\nimport template from './help.html'\nimport helpMarkdown from './help.md'\nimport 'angular-marked'\n\nclass HelpController {\n    constructor(){\n        this.content = helpMarkdown\n    }\n}\n\nexport default angular\n    .module('c4-lab.help', ['hc.marked'])\n    .component('c4LabHelp', {\n        template,\n        controller: HelpController\n    })\n    .name\n\n\n// WEBPACK FOOTER //\n// ./src/help/index.js","module.exports = \"<c4-lab-nav></c4-lab-nav>\\n<div marked=\\\"$ctrl.content\\\"></div>\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/help/help.html\n// module id = 588\n// module chunks = 1","module.exports = \"# C4-Lab Help\\n\\nC4-Lab defines a domain specific language (DSL) for creating software\\narchitectures, modeled heavily after [Simon Brown][SB]'s [C4][] approach\\n(Context, Containers, Components, and Classes). See [Visualising Software\\nArchitecture][] for more information.\\n\\n[SB]: http://www.simonbrown.je/\\n[C4]: http://www.codingthearchitecture.com/2014/08/24/c4_model_poster.html\\n[Visualising Software Architecture]: https://leanpub.com/visualising-software-architecture\\n\\n## Features\\n\\nC4-Lab has import, export, and \\\"share\\\" features accessible in the top\\nnavigation, and saves work-in-progress in your browser.  If you want to save a\\ngraph for later editing, export the `sexp` format, or save the \\\"share\\\" link.\\nOther exports do not allow resuming editing.\\n\\n## Syntax\\n\\nThe DSL uses [s-expression][]s to represent the hierarchy and connections\\nbetween actors, systems, containers, and components. If you squint your eyes, it\\nlooks like common lisp or scheme macros.\\n\\nWe use the excellent [CodeMirror][] in-browser editor to add syntax highlighting\\nand some help with managing the parentheses.\\n\\n[CodeMirror]: https://codemirror.net/\\n[s-expression]: https://en.wikipedia.org/wiki/S-expression\\n\\n### Full example\\n\\nHere's a small bit of software archicture for a web application, demonstrating\\nsome of the syntax.\\n\\n    (define-actor (\\\"customer\\\")\\n      (edge :to \\\"dog rater\\\" :description \\\"views/votes/uploads dog pictures\\\"))\\n\\n    (define-system (\\\"dog rater\\\" :desc \\\"fun clickbait website\\\")\\n\\n      (def-container (\\\"frontend\\\" :tech \\\"typescript, reactjs\\\")\\n        (edge :to \\\"./database\\\" :desc \\\"display sweet dog pictures\\\" \\n              :direction \\\"both\\\")\\n        )\\n\\n      (def-container (\\\"backend\\\" :tech \\\"golang\\\")\\n        (def-component (\\\"ad provider\\\")\\n          (edge :to \\\"third party ad network\\\" :desc \\\"fetch user-specific ads\\\")\\n          )\\n        )\\n\\n      (def-container (\\\"database\\\" :tech \\\"amazon S3\\\"))\\n    )\\n\\n    (def-system (\\\"third party ad network\\\" :desc \\\"advert network\\\"))\\n\\n### Actors\\n\\nTop level element, represents a human using the software.\\n\\nExamples:\\n\\n    (define-actor (\\\"customer\\\")\\n      ;; optional edges to other parts of the architecture\\n      )\\n\\nIf this were a real lisp macro, it's definition would look like:\\n\\n    (defmacro define-actor ((name) &body children))\\n\\n### Systems\\n\\nTop level element, represents a logical software system.\\n\\nExamples:\\n\\n    (define-system (\\\"name of the system\\\" :description \\\"optional description\\\" \\n                                         :tech \\\"optional technology\\\")\\n      ;; optional children of this system; edges or containers\\n      )\\n    (def-system (\\\"name of the system\\\" :desc \\\"can abbreviate a little; :desc vs :description, def-system vs define-system\\\"))\\n\\nIf this were a real lisp macro, it's definition would look like:\\n\\n    (defmacro define-system ((name) &key description tech &body children))\\n\\n### Containers\\n\\nContainers are independently deployable pieces of a system. They should be used as children of a `def-system`\\n\\nExamples:\\n\\n    (def-system (\\\"dog ratr\\\")\\n      (def-container (\\\"frontend\\\" :tech \\\"...\\\" :desc \\\"...\\\")\\n        ;; optional children of this system; edges or components\\n      )\\n    )\\n\\nIf this were a real lisp macro, it's definition would look like:\\n\\n    (defmacro define-container ((name) &key description tech &body children))\\n\\n### Components\\n\\nComponents are pieces of one deployable part of a system. These could be things\\nlike java packages, C# assemblies, ES6 modules, etc. They should be used as\\nchildren of a `def-container`\\n\\nExamples:\\n\\n    (def-system (\\\"dog ratr\\\")\\n      (def-container (\\\"frontend\\\")\\n        (def-component (\\\"upload page\\\" :tech \\\"...\\\" :desc \\\"...\\\"))\\n        (def-component (\\\"dog browser\\\")\\n          ;; optional children, edges\\n        )\\n      )\\n    )\\n\\nIf this were a real lisp macro, it's definition would look like:\\n\\n    (defmacro define-component ((name) &key description tech &body children))\\n\\n### Edges\\n\\nEdges represent connections between the different elements in a software\\narchitecture. These have a few different options for how to connect things.\\nConnections are specified using something like a file path to unambiguously\\nidentify the destination of an edge.\\n\\nThey can be used as children of `def-actor`, `def-system`, `def-container`, and\\n`def-component`.\\n\\nYou can customize the direction of the edge using the `:direction` (`:dir` for\\nshort) option. The valid options are:\\n\\n* `push` - (default), indicates this node is reaching out to the target. Draws\\n  an arrow from the current node to the target.\\n* `pull` - indicates this node is pulling from the target, e.g. as a subscriber.\\n  Draws an arrow from the target to the current node.\\n* `both` - indicates bidrectional flow of actions/information. Draws an arrow to\\n  and from the target to the current node.\\n\\nExamples:\\n\\n    (def-actor (\\\"customer\\\")\\n      ;; connect this actor to the dog ratr system, and describe\\n      ;; how the actor uses the system\\n      (edge :to \\\"dog ratr\\\" :desc \\\"clicks a lot of links and ads\\\"))\\n\\n    (def-system (\\\"dog ratr\\\")\\n      (def-container (\\\"frontend\\\")\\n        ;; connect the frontend to the backend, with a relative path\\n        (edge :to \\\"./backend\\\" :desc \\\"fetch list of dogs\\\" :dir \\\"both\\\")\\n        ;; can specify a \\\"full\\\" path to connect with nodes that aren't\\n        ;; on the top level\\n        (edge :to \\\"ad server/click tracker\\\" :desc \\\"records a click via HTTP\\\")\\n      )\\n      (def-container (\\\"backend\\\"))\\n    )\\n\\n    (def-system (\\\"ad server\\\")\\n      (def-container (\\\"click tracker\\\")))\\n\\nIf this were a real lisp function, it's definition would look like:\\n\\n    (defun edge (&key to description (direction \\\"both\\\")))\\n\\n### Comments\\n\\nComments are of questionable use since they don't show up in the diagrams at\\nall, but they are useful for commenting out code while you're still hasing out\\nthe architecture.\\n\\nAny content after two colons is ignored as a comment.\\n\\nExamples:\\n\\n    ;; this whole line is a comment\\n    (def-system (\\\"dog ratr\\\")) ;; this bit is ignored, too\\n\"\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/help/help.md\n// module id = 589\n// module chunks = 1","import * as angular from 'angular'\nimport { StateService } from 'angular-ui-router'\nimport { INgRedux, INgReduxProvider, Middleware } from 'ng-redux'\nimport 'ng-redux'\nimport { Action, applyMiddleware, Dispatch, Store } from 'redux'\nimport createSagaMiddleware from 'redux-saga'\nimport rootReducer from './reducers'\nimport { rootSaga } from './sagas'\nimport { IState } from './state'\n\nconst timingMiddleware: any = (store: Store<IState>) => (next: Dispatch<IState>) => (action: Action) => {\n    // tslint:disable:no-console\n    const label = `Processing ${action.type}`\n    console.time(label)\n    console.group(label)\n    try {\n        return next(action)\n    } finally {\n        console.timeEnd(label)\n        console.groupEnd()\n    }\n    // tslint:enable:no-console\n}\n\n// tslint:disable-next-line:ban-types\nconst enhancers: Function[] = []\nconst reduxDevtool = (window as any).__REDUX_DEVTOOLS_EXTENSION__\nif (reduxDevtool) { enhancers.push(reduxDevtool()) }\nconst sagas = createSagaMiddleware()\n\nexport default angular.module('c4-lab.store', ['ngRedux'])\n    .config(($ngReduxProvider: INgReduxProvider) => {\n        $ngReduxProvider.createStoreWith(rootReducer, [timingMiddleware, sagas], enhancers)\n    })\n    .run(($ngRedux: INgRedux) => {\n        sagas.run(rootSaga)\n    })\n    .name\n\n\n\n// WEBPACK FOOTER //\n// ./node_modules/source-map-loader!./node_modules/tslint-loader!./src/store/store.module.ts","import { StateService } from 'angular-ui-router'\nimport actionCreatorFactory from 'typescript-fsa'\nimport { IGraph, NodeId } from '../core/interfaces'\n\nexport interface IEditorParseEvent {\n    graph: IGraph\n}\n\nexport interface IEditorParseError {\n    error: string,\n    line?: number,\n    column?: number\n}\n\nexport interface ISourceChanged {\n    source: string\n}\n\nexport interface IZoomChanged {\n    zoomNodeId: NodeId | null\n}\n\nexport interface IDotChanged {\n    dot: string\n}\nexport interface ISvgChanged {\n    svg: string\n}\n\nexport interface IAngularInitialized {\n    $state: StateService,\n    $window: Window\n}\n\nconst actionCreator = actionCreatorFactory()\n\nexport const sourceParsed = actionCreator<IEditorParseEvent>('C4_SOURCE_PARSED')\nexport const sourceParseError = actionCreator<IEditorParseError>('C4_SOURCE_PARSE_ERROR')\nexport const sourceChanged = actionCreator<ISourceChanged>('C4_SOURCE_CHANGED')\nexport const dotChanged = actionCreator<IDotChanged>('C4_DOT_CHANGED')\nexport const svgChanged = actionCreator<ISvgChanged>('C4_SVG_CHANGED')\nexport const angularInitialized = actionCreator<IAngularInitialized>('C4_ANGULAR_INITIALIZED')\nexport const zoomChanged = actionCreator<IZoomChanged>('C4_ZOOM_CHANGED')\n\n\n\n// WEBPACK FOOTER //\n// ./node_modules/source-map-loader!./node_modules/tslint-loader!./src/store/actions.ts","export default class ParseError extends Error { }\n\n\n\n// WEBPACK FOOTER //\n// ./node_modules/source-map-loader!./node_modules/tslint-loader!./src/core/parse/ParseError.ts","import { StateService } from 'angular-ui-router'\nimport { combineReducers } from 'redux'\nimport { reducerWithInitialState } from 'typescript-fsa-reducers'\nimport { IGraph, INode, NodeId } from '../../core/interfaces'\nimport {\n    angularInitialized, dotChanged, sourceChanged,\n    sourceParsed, sourceParseError, svgChanged, zoomChanged,\n} from '../actions'\nimport { IState } from '../state'\nimport sample from './c4lab.sexp'\n\nexport const initialState: IState = {\n    graph: null,\n    parseError: null,\n    source: sample,\n    zoomNodeId: null,\n    zoomableNodes: [],\n}\n\nconst sourceReducer = reducerWithInitialState(sample)\n    .case(sourceChanged, (old, evt) => evt.source)\n    .build()\n\n// TODO: not need this; there's gotta be some config to teach jest's\n// typescript preprocessor to respect the additional types\nconst testSafeSourceReducer = (src: string, evt: any) =>\n    sourceReducer(src, evt) || ''\n\nconst parseErrorReducer = reducerWithInitialState<string | null>(null)\n    .case(sourceParseError, (old, evt) => evt.error)\n    .case(sourceParsed, (old, evt) => null)\n    .build()\n\nconst graphReducer = reducerWithInitialState<IGraph | null>(null)\n    .case(sourceParsed, (old, evt) => evt.graph)\n    .build()\n\nconst zoomableNodesReducer = reducerWithInitialState<INode[]>([])\n    .case(sourceParsed, (old, evt) => evt.graph.items\n        .filter((x) => x.canExpand)\n        .sort((a, b) => a.path.localeCompare(b.path)))\n    .build()\n\nconst zoomNodeIdReducer = reducerWithInitialState<NodeId | null>(null)\n    .case(zoomChanged, (old, evt) => evt.zoomNodeId || null)\n    .build()\n\nconst dotReducer = reducerWithInitialState<string | null>(null)\n    .case(dotChanged, (old, evt) => evt.dot)\n    .build()\n\nconst svgReducer = reducerWithInitialState<string | null>(null)\n    .case(svgChanged, (old, evt) => evt.svg)\n    .build()\n\nconst stateReducer = reducerWithInitialState<StateService | null>(null)\n    .case(angularInitialized, (old, evt) => evt.$state)\n    .build()\n\nconst windowReducer = reducerWithInitialState<Window | null>(null)\n    .case(angularInitialized, (old, evt) => evt.$window)\n    .build()\n\nconst rootReducer = combineReducers<IState>({\n    $state: stateReducer,\n    $window: windowReducer,\n    dot: dotReducer,\n    graph: graphReducer,\n    parseError: parseErrorReducer,\n    source: testSafeSourceReducer,\n    svg: svgReducer,\n    zoomNodeId: zoomNodeIdReducer,\n    zoomableNodes: zoomableNodesReducer,\n})\n\nexport default rootReducer\n\n\n\n// WEBPACK FOOTER //\n// ./node_modules/source-map-loader!./node_modules/tslint-loader!./src/store/reducers/index.ts","module.exports = \"(title \\\"c4-lab\\\")\\n;; add an actor to represent humans that use your system\\n(define-actor (\\\"Devs\\\")\\n  ;; add edges to say what part of your system the actor uses\\n  (edge\\n   ;; specify where the other end of this edge is using something like a path\\n   ;; \\\"C4 Lab/UI\\\" points at the \\\"C4 Lab\\\" system, the the \\\"UI\\\" container inside\\n   :to \\\"C4 Lab/UI\\\"\\n   :description \\\"Create/read/update designs\\\")\\n  )\\n;; add your system\\n(define-system (\\\"C4 Lab\\\"\\n                :description \\\"Web-based rapid prototyping of C4 diagrams to augment whiteboards\\\")\\n  ;; add the containers inside your system\\n  (def-container (\\\"UI\\\" :tech \\\"html5, angularjs\\\"\\n                       :description \\\"prototype, import, export C4 diagrams\\\" ))\\n  )\\n(define-system (\\\"Github\\\" :description \\\"Free git and web hosting\\\")\\n  ;; add edges between any actor, system, or container\\n  (edge :description \\\"hosts\\\" :to \\\"C4 Lab/UI\\\")\\n  (edge :to \\\"Travis-ci\\\" :description \\\"triggers build\\\")\\n  )\\n(define-system (\\\"Travis-ci\\\" :description \\\"Open source CI\\\")\\n  (edge :to \\\"Github\\\" :description \\\"publishes\\\"))\\n;; any line that starts with \\\";;\\\" is a comment\\n\"\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/store/reducers/c4lab.sexp\n// module id = 671\n// module chunks = 1","import { StateService } from '@uirouter/core'\nimport { SagaIterator } from 'redux-saga'\nimport { all, call, put, select, take, takeLatest, throttle } from 'redux-saga/effects'\nimport { Action } from 'typescript-fsa'\nimport { DataStore, parse, toDot, toSvg } from '../core'\nimport { NodeId } from '../core/interfaces'\nimport {\n    angularInitialized, dotChanged, ISourceChanged, IZoomChanged, sourceChanged,\n    sourceParsed, sourceParseError, svgChanged, zoomChanged,\n} from './actions'\n\nfunction* onSourceChanged(action: Action<ISourceChanged>): SagaIterator {\n    try {\n        const graph = parse(action.payload.source)\n        yield put(sourceParsed({ graph }))\n    } catch (error) {\n        yield put(sourceParseError({ error: error.message }))\n    }\n}\n\nfunction hrefTo($state: StateService, zoom: NodeId) {\n    const name = $state.current.name\n    if (name === undefined) { return '' }\n    const params = Object.assign({}, $state.params, { zoom })\n    return $state.href(name, params)\n}\n\nfunction* render(): SagaIterator {\n    // TODO: make this type safe, need to mess with NodeId being nullable\n    const { zoomNodeId, graph, $state, $window, source } = yield select()\n\n    new DataStore($window.localStorage).save(source)\n\n    // TODO: resolve race condition where we call this method before $state.current exists\n    // so we can drop this wait\n    while (!($state.current && $state.current.name)) {\n        yield call(wait)\n    }\n    const dot = toDot(graph, zoomNodeId, (x) => hrefTo($state, x))\n    yield put(dotChanged({ dot }))\n    const svg = toSvg(dot)\n    yield put(svgChanged({ svg }))\n}\n\nfunction wait(ms = 50) {\n    return new Promise((resolve) => setTimeout(resolve, ms))\n}\n\nfunction* updateZoom(action: Action<IZoomChanged>): SagaIterator {\n    const { $state } = yield select()\n    const { zoomNodeId: zoom } = action.payload\n    if (zoom === $state.params.zoom) { return }\n    yield call(render)\n    const name = $state.current.name\n    if (name) {\n        const params = Object.assign({}, $state.params, { zoom })\n        $state.go(name, params, { notify: false })\n    }\n}\n\nfunction* latestSource(): SagaIterator { yield takeLatest(sourceChanged, onSourceChanged) }\nfunction* latestGraph(): SagaIterator { yield takeLatest(sourceParsed, render) }\nfunction* latestZoom(): SagaIterator { yield throttle(100, zoomChanged, updateZoom) }\n\nfunction* init(): SagaIterator {\n    yield take(angularInitialized.type)\n    const { $window } = yield select()\n    if (!$window.localStorage) { return } // TODO: hack to make tests happy\n    const storage = new DataStore($window.localStorage)\n    const source = storage.load()\n    if (source) { yield put(sourceChanged({ source })) }\n}\n\nexport function* rootSaga(): SagaIterator {\n    yield all([\n        call(latestSource),\n        call(latestGraph),\n        call(latestZoom),\n        call(init),\n    ])\n}\n\n\n\n// WEBPACK FOOTER //\n// ./node_modules/source-map-loader!./node_modules/tslint-loader!./src/store/sagas.ts"],"sourceRoot":""}